{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/nam/OneDrive/M\\xE1y t\\xEDnh/New folder/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/nam/OneDrive/M\\xE1y t\\xEDnh/New folder/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _classCallCheck from \"C:/Users/nam/OneDrive/M\\xE1y t\\xEDnh/New folder/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"C:/Users/nam/OneDrive/M\\xE1y t\\xEDnh/New folder/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.object.entries.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport vue from \"@/main\";\nimport store from \"@/store\";\nimport * as msal from \"@azure/msal-browser\";\n\nvar AuthService = /*#__PURE__*/function () {\n  function AuthService() {\n    _classCallCheck(this, AuthService);\n\n    this.configured = false;\n    this.msalApp = null;\n  }\n\n  _createClass(AuthService, [{\n    key: \"configure\",\n    value: function () {\n      var _configure = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(clientId) {\n        var config;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!this.configured) {\n                  _context.next = 2;\n                  break;\n                }\n\n                return _context.abrupt(\"return\");\n\n              case 2:\n                if (clientId) {\n                  _context.next = 4;\n                  break;\n                }\n\n                return _context.abrupt(\"return\");\n\n              case 4:\n                config = {\n                  auth: {\n                    clientId: clientId,\n                    redirectUri: window.location.origin,\n                    authority: \"https://login.microsoftonline.com/common\"\n                  },\n                  cache: {\n                    cacheLocation: \"localStorage\"\n                  }\n                };\n                this.msalApp = new msal.PublicClientApplication(config);\n                this.configured = true;\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function configure(_x) {\n        return _configure.apply(this, arguments);\n      }\n\n      return configure;\n    }()\n  }, {\n    key: \"clientId\",\n    value: function clientId() {\n      if (!this.msalApp) {\n        return null;\n      }\n\n      return this.msalApp.config.auth.clientId;\n    }\n  }, {\n    key: \"login\",\n    value: function () {\n      var _login = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var scopes,\n            _args2 = arguments;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                scopes = _args2.length > 0 && _args2[0] !== undefined ? _args2[0] : [\"user.read\", \"openid\", \"profile\", \"email\"];\n\n                if (!this.isConfigured) {\n                  this.configure(store.state.config.azureAppId);\n                }\n\n                if (this.msalApp) {\n                  _context2.next = 4;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\");\n\n              case 4:\n                _context2.next = 6;\n                return this.msalApp.loginPopup({\n                  scopes: scopes,\n                  prompt: \"select_account\"\n                });\n\n              case 6:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function login() {\n        return _login.apply(this, arguments);\n      }\n\n      return login;\n    }()\n  }, {\n    key: \"logout\",\n    value: function logout() {\n      if (!this.msalApp) {\n        return;\n      }\n\n      this.msalApp.logoutPopup();\n    }\n  }, {\n    key: \"user\",\n    value: function user() {\n      if (!this.msalApp) {\n        return null;\n      }\n\n      var currentAccounts = this.msalApp.getAllAccounts();\n\n      if (!currentAccounts || currentAccounts.length === 0) {\n        // No user signed in\n        return null;\n      } else if (currentAccounts.length > 1) {\n        return currentAccounts[0];\n      } else {\n        return currentAccounts[0];\n      }\n    }\n  }, {\n    key: \"acquireToken\",\n    value: function () {\n      var _acquireToken = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        var scopes,\n            accessTokenRequest,\n            tokenResp,\n            _args3 = arguments;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                scopes = _args3.length > 0 && _args3[0] !== undefined ? _args3[0] : [\"user.read\"];\n\n                if (this.msalApp) {\n                  _context3.next = 3;\n                  break;\n                }\n\n                return _context3.abrupt(\"return\", null);\n\n              case 3:\n                accessTokenRequest = {\n                  scopes: scopes,\n                  account: this.user()\n                };\n                _context3.prev = 4;\n                _context3.next = 7;\n                return this.msalApp.acquireTokenSilent(accessTokenRequest);\n\n              case 7:\n                tokenResp = _context3.sent;\n                _context3.next = 15;\n                break;\n\n              case 10:\n                _context3.prev = 10;\n                _context3.t0 = _context3[\"catch\"](4);\n                _context3.next = 14;\n                return this.msalApp.acquireTokenPopup(accessTokenRequest);\n\n              case 14:\n                tokenResp = _context3.sent;\n\n              case 15:\n                if (tokenResp.accessToken) {\n                  _context3.next = 17;\n                  break;\n                }\n\n                throw new Error(vue.$t(\"error.access_token\"));\n\n              case 17:\n                return _context3.abrupt(\"return\", tokenResp.accessToken);\n\n              case 18:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[4, 10]]);\n      }));\n\n      function acquireToken() {\n        return _acquireToken.apply(this, arguments);\n      }\n\n      return acquireToken;\n    }()\n  }, {\n    key: \"clearLocal\",\n    value: function clearLocal() {\n      if (this.msalApp) {\n        for (var _i = 0, _Object$entries = Object.entries(localStorage); _i < _Object$entries.length; _i++) {\n          var entry = _Object$entries[_i];\n          var key = entry[0];\n\n          if (key.includes(\"login.windows\")) {\n            localStorage.removeItem(key);\n          }\n        }\n      }\n    }\n  }, {\n    key: \"isConfigured\",\n    get: function get() {\n      return this.configured;\n    }\n  }]);\n\n  return AuthService;\n}();\n\nvar authService = new AuthService();\nexport default authService;","map":{"version":3,"names":["vue","store","msal","AuthService","configured","msalApp","clientId","config","auth","redirectUri","window","location","origin","authority","cache","cacheLocation","PublicClientApplication","scopes","isConfigured","configure","state","azureAppId","loginPopup","prompt","logoutPopup","currentAccounts","getAllAccounts","length","accessTokenRequest","account","user","acquireTokenSilent","tokenResp","acquireTokenPopup","accessToken","Error","$t","Object","entries","localStorage","entry","key","includes","removeItem","authService"],"sources":["C:/Users/nam/OneDrive/Máy tính/New folder/src/modules/graph/services/auth.service.js"],"sourcesContent":["import vue from \"@/main\";\r\nimport store from \"@/store\";\r\nimport * as msal from \"@azure/msal-browser\";\r\nclass AuthService {\r\n\tconstructor() {\r\n\t\tthis.configured = false;\r\n\t\tthis.msalApp = null;\r\n\t}\r\n\tasync configure(clientId) {\r\n\t\tif (this.configured) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!clientId) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst config = {\r\n\t\t\tauth: {\r\n\t\t\t\tclientId: clientId,\r\n\t\t\t\tredirectUri: window.location.origin,\r\n\t\t\t\tauthority: \"https://login.microsoftonline.com/common\",\r\n\t\t\t},\r\n\t\t\tcache: {\r\n\t\t\t\tcacheLocation: \"localStorage\",\r\n\t\t\t},\r\n\t\t};\r\n\r\n\t\tthis.msalApp = new msal.PublicClientApplication(config);\r\n\t\tthis.configured = true;\r\n\t}\r\n\r\n\tclientId() {\r\n\t\tif (!this.msalApp) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn this.msalApp.config.auth.clientId;\r\n\t}\r\n\r\n\tasync login(scopes = [\"user.read\", \"openid\", \"profile\", \"email\"]) {\r\n\t\tif (!this.isConfigured) {\r\n\t\t\tthis.configure(store.state.config.azureAppId);\r\n\t\t}\r\n\t\tif (!this.msalApp) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tawait this.msalApp.loginPopup({\r\n\t\t\tscopes,\r\n\t\t\tprompt: \"select_account\",\r\n\t\t});\r\n\t}\r\n\r\n\tlogout() {\r\n\t\tif (!this.msalApp) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.msalApp.logoutPopup();\r\n\t}\r\n\r\n\tuser() {\r\n\t\tif (!this.msalApp) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst currentAccounts = this.msalApp.getAllAccounts();\r\n\t\tif (!currentAccounts || currentAccounts.length === 0) {\r\n\t\t\t// No user signed in\r\n\t\t\treturn null;\r\n\t\t} else if (currentAccounts.length > 1) {\r\n\t\t\treturn currentAccounts[0];\r\n\t\t} else {\r\n\t\t\treturn currentAccounts[0];\r\n\t\t}\r\n\t}\r\n\r\n\tasync acquireToken(scopes = [\"user.read\"]) {\r\n\t\tif (!this.msalApp) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst accessTokenRequest = {\r\n\t\t\tscopes,\r\n\t\t\taccount: this.user(),\r\n\t\t};\r\n\r\n\t\tlet tokenResp;\r\n\t\ttry {\r\n\t\t\ttokenResp = await this.msalApp.acquireTokenSilent(\r\n\t\t\t\taccessTokenRequest,\r\n\t\t\t);\r\n\t\t} catch (err) {\r\n\t\t\ttokenResp = await this.msalApp.acquireTokenPopup(\r\n\t\t\t\taccessTokenRequest,\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tif (!tokenResp.accessToken) {\r\n\t\t\tthrow new Error(vue.$t(\"error.access_token\"));\r\n\t\t}\r\n\r\n\t\treturn tokenResp.accessToken;\r\n\t}\r\n\tclearLocal() {\r\n\t\tif (this.msalApp) {\r\n\t\t\tfor (let entry of Object.entries(localStorage)) {\r\n\t\t\t\tlet key = entry[0];\r\n\t\t\t\tif (key.includes(\"login.windows\")) {\r\n\t\t\t\t\tlocalStorage.removeItem(key);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tget isConfigured() {\r\n\t\treturn this.configured;\r\n\t}\r\n}\r\nconst authService = new AuthService();\r\nexport default authService;\r\n"],"mappings":";;;;;;;;AAAA,OAAOA,GAAP,MAAgB,QAAhB;AACA,OAAOC,KAAP,MAAkB,SAAlB;AACA,OAAO,KAAKC,IAAZ,MAAsB,qBAAtB;;IACMC,W;EACL,uBAAc;IAAA;;IACb,KAAKC,UAAL,GAAkB,KAAlB;IACA,KAAKC,OAAL,GAAe,IAAf;EACA;;;;;kFACD,iBAAgBC,QAAhB;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,KACK,KAAKF,UADV;kBAAA;kBAAA;gBAAA;;gBAAA;;cAAA;gBAAA,IAKME,QALN;kBAAA;kBAAA;gBAAA;;gBAAA;;cAAA;gBASOC,MATP,GASgB;kBACdC,IAAI,EAAE;oBACLF,QAAQ,EAAEA,QADL;oBAELG,WAAW,EAAEC,MAAM,CAACC,QAAP,CAAgBC,MAFxB;oBAGLC,SAAS,EAAE;kBAHN,CADQ;kBAMdC,KAAK,EAAE;oBACNC,aAAa,EAAE;kBADT;gBANO,CAThB;gBAoBC,KAAKV,OAAL,GAAe,IAAIH,IAAI,CAACc,uBAAT,CAAiCT,MAAjC,CAAf;gBACA,KAAKH,UAAL,GAAkB,IAAlB;;cArBD;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA,C;;;;;;;;;;WAwBA,oBAAW;MACV,IAAI,CAAC,KAAKC,OAAV,EAAmB;QAClB,OAAO,IAAP;MACA;;MAED,OAAO,KAAKA,OAAL,CAAaE,MAAb,CAAoBC,IAApB,CAAyBF,QAAhC;IACA;;;;8EAED;QAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAYW,MAAZ,8DAAqB,CAAC,WAAD,EAAc,QAAd,EAAwB,SAAxB,EAAmC,OAAnC,CAArB;;gBACC,IAAI,CAAC,KAAKC,YAAV,EAAwB;kBACvB,KAAKC,SAAL,CAAelB,KAAK,CAACmB,KAAN,CAAYb,MAAZ,CAAmBc,UAAlC;gBACA;;gBAHF,IAIM,KAAKhB,OAJX;kBAAA;kBAAA;gBAAA;;gBAAA;;cAAA;gBAAA;gBAAA,OAQO,KAAKA,OAAL,CAAaiB,UAAb,CAAwB;kBAC7BL,MAAM,EAANA,MAD6B;kBAE7BM,MAAM,EAAE;gBAFqB,CAAxB,CARP;;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA,C;;;;;;;;;;WAcA,kBAAS;MACR,IAAI,CAAC,KAAKlB,OAAV,EAAmB;QAClB;MACA;;MAED,KAAKA,OAAL,CAAamB,WAAb;IACA;;;WAED,gBAAO;MACN,IAAI,CAAC,KAAKnB,OAAV,EAAmB;QAClB,OAAO,IAAP;MACA;;MAED,IAAMoB,eAAe,GAAG,KAAKpB,OAAL,CAAaqB,cAAb,EAAxB;;MACA,IAAI,CAACD,eAAD,IAAoBA,eAAe,CAACE,MAAhB,KAA2B,CAAnD,EAAsD;QACrD;QACA,OAAO,IAAP;MACA,CAHD,MAGO,IAAIF,eAAe,CAACE,MAAhB,GAAyB,CAA7B,EAAgC;QACtC,OAAOF,eAAe,CAAC,CAAD,CAAtB;MACA,CAFM,MAEA;QACN,OAAOA,eAAe,CAAC,CAAD,CAAtB;MACA;IACD;;;;qFAED;QAAA;QAAA;QAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAmBR,MAAnB,8DAA4B,CAAC,WAAD,CAA5B;;gBAAA,IACM,KAAKZ,OADX;kBAAA;kBAAA;gBAAA;;gBAAA,kCAES,IAFT;;cAAA;gBAKOuB,kBALP,GAK4B;kBAC1BX,MAAM,EAANA,MAD0B;kBAE1BY,OAAO,EAAE,KAAKC,IAAL;gBAFiB,CAL5B;gBAAA;gBAAA;gBAAA,OAYoB,KAAKzB,OAAL,CAAa0B,kBAAb,CACjBH,kBADiB,CAZpB;;cAAA;gBAYEI,SAZF;gBAAA;gBAAA;;cAAA;gBAAA;gBAAA;gBAAA;gBAAA,OAgBoB,KAAK3B,OAAL,CAAa4B,iBAAb,CACjBL,kBADiB,CAhBpB;;cAAA;gBAgBEI,SAhBF;;cAAA;gBAAA,IAqBMA,SAAS,CAACE,WArBhB;kBAAA;kBAAA;gBAAA;;gBAAA,MAsBQ,IAAIC,KAAJ,CAAUnC,GAAG,CAACoC,EAAJ,CAAO,oBAAP,CAAV,CAtBR;;cAAA;gBAAA,kCAyBQJ,SAAS,CAACE,WAzBlB;;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA,C;;;;;;;;;;WA2BA,sBAAa;MACZ,IAAI,KAAK7B,OAAT,EAAkB;QACjB,mCAAkBgC,MAAM,CAACC,OAAP,CAAeC,YAAf,CAAlB,qCAAgD;UAA3C,IAAIC,KAAK,sBAAT;UACJ,IAAIC,GAAG,GAAGD,KAAK,CAAC,CAAD,CAAf;;UACA,IAAIC,GAAG,CAACC,QAAJ,CAAa,eAAb,CAAJ,EAAmC;YAClCH,YAAY,CAACI,UAAb,CAAwBF,GAAxB;UACA;QACD;MACD;IACD;;;SACD,eAAmB;MAClB,OAAO,KAAKrC,UAAZ;IACA;;;;;;AAEF,IAAMwC,WAAW,GAAG,IAAIzC,WAAJ,EAApB;AACA,eAAeyC,WAAf"},"metadata":{},"sourceType":"module"}