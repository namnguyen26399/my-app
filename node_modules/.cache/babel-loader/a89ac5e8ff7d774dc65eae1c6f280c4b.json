{"ast":null,"code":"import _createForOfIteratorHelper from \"C:/Users/nam/OneDrive/M\\xE1y t\\xEDnh/New folder/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _regeneratorRuntime from \"C:/Users/nam/OneDrive/M\\xE1y t\\xEDnh/New folder/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/nam/OneDrive/M\\xE1y t\\xEDnh/New folder/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.array.splice.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport BreadcrumbsVue from \"@/components/Breadcrumbs.vue\";\nimport TabVue from \"@/components/Tab.vue\";\nimport TemplateFormDto from \"@/models/template-form.dto\";\nimport globalService from \"@/services/global.service\";\nimport administratorAPI from \"../administrator.api\";\nexport default {\n  name: \"EditTempalteFormV2Vue\",\n  components: {\n    BreadcrumbsVue: BreadcrumbsVue,\n    TabVue: TabVue\n  },\n  computed: {\n    items: function items() {\n      try {\n        return JSON.parse(this.templateForm.mappingInfo);\n      } catch (_unused) {\n        return [];\n      }\n    }\n  },\n  watch: {\n    \"templateForm.attachmentFileDTOS\": function () {\n      var _templateFormAttachmentFileDTOS = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(value) {\n        var response, id;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                id = value[0].id;\n                _context.next = 4;\n                return globalService.getData_Async(administratorAPI.API_GetPreviewLink(id));\n\n              case 4:\n                response = _context.sent;\n\n                if (!(!response || !response.state)) {\n                  _context.next = 7;\n                  break;\n                }\n\n                return _context.abrupt(\"return\");\n\n              case 7:\n                this.previewLink = response.data;\n                _context.next = 13;\n                break;\n\n              case 10:\n                _context.prev = 10;\n                _context.t0 = _context[\"catch\"](0);\n                return _context.abrupt(\"return\");\n\n              case 13:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 10]]);\n      }));\n\n      function templateFormAttachmentFileDTOS(_x) {\n        return _templateFormAttachmentFileDTOS.apply(this, arguments);\n      }\n\n      return templateFormAttachmentFileDTOS;\n    }()\n  },\n  data: function data() {\n    return {\n      tabs: [{\n        key: \"information\",\n        title: this.$t(\"label.information\")\n      }],\n      buttons: [{\n        icon: \"mdi-content-save\",\n        title: this.$t(\"button.save\"),\n        color: \"blue darken-2\",\n        transparent: false,\n        dark: true,\n        event: this.save\n      }, {\n        icon: \"mdi-trash-can-outline\",\n        title: this.$t(\"button.delete\"),\n        color: \"black\",\n        transparent: true,\n        dark: false,\n        event: this.delete\n      }, {\n        icon: \"mdi-arrow-left-top\",\n        title: this.$t(\"button.back\"),\n        color: \"black\",\n        transparent: true,\n        dark: false,\n        event: this.back\n      }],\n      templateForm: Object.assign({}, TemplateFormDto),\n      headers: [{\n        text: this.$t(\"label.name\"),\n        align: \"start\",\n        value: \"name\"\n      }, {\n        text: this.$t(\"label.position_in_file\"),\n        align: \"start\",\n        value: \"position\"\n      }, {\n        text: this.$t(\"label.manipulation\"),\n        align: \"start\",\n        sortable: false,\n        value: \"action\"\n      }],\n      creating: false,\n      editing: false,\n      mapping: {\n        name: \"\",\n        position: \"\"\n      },\n      previewLink: \"\"\n    };\n  },\n  created: function created() {\n    var _this = this;\n\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return _this.initialize();\n\n            case 2:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }))();\n  },\n  mounted: function mounted() {},\n  methods: {\n    initialize: function initialize() {\n      var _this2 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        var response;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (_this2.$router.currentRoute.params.id) {\n                  _context3.next = 4;\n                  break;\n                }\n\n                _this2.templateForm = Object.assign({}, TemplateFormDto);\n                _context3.next = 17;\n                break;\n\n              case 4:\n                _context3.prev = 4;\n                _context3.next = 7;\n                return globalService.getData_Async(administratorAPI.API_GetTemplateForm(_this2.$router.currentRoute.params.id));\n\n              case 7:\n                response = _context3.sent;\n\n                if (!(!response || !response.state)) {\n                  _context3.next = 11;\n                  break;\n                }\n\n                _this2.$router.push({\n                  path: \"./\"\n                });\n\n                return _context3.abrupt(\"return\");\n\n              case 11:\n                _this2.templateForm = response.data;\n                _context3.next = 17;\n                break;\n\n              case 14:\n                _context3.prev = 14;\n                _context3.t0 = _context3[\"catch\"](4);\n\n                _this2.$router.push({\n                  path: \"./\"\n                });\n\n              case 17:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, null, [[4, 14]]);\n      }))();\n    },\n    handleButtonClick: function handleButtonClick(event) {\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.next = 2;\n                return event();\n\n              case 2:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4);\n      }))();\n    },\n    handleFile: function handleFile(event) {\n      var _this3 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5() {\n        var canUpload, response, _iterator, _step, item;\n\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                if (event) {\n                  _context5.next = 2;\n                  break;\n                }\n\n                return _context5.abrupt(\"return\");\n\n              case 2:\n                canUpload = true;\n\n                if (_this3.templateForm.id) {\n                  _context5.next = 7;\n                  break;\n                }\n\n                _context5.next = 6;\n                return _this3.save();\n\n              case 6:\n                canUpload = _context5.sent;\n\n              case 7:\n                if (canUpload) {\n                  _context5.next = 9;\n                  break;\n                }\n\n                return _context5.abrupt(\"return\");\n\n              case 9:\n                console.log(\"event up\", event);\n                _context5.prev = 10;\n\n                if (!_this3.templateForm.attachmentFileDTOS.length) {\n                  _context5.next = 32;\n                  break;\n                }\n\n                _iterator = _createForOfIteratorHelper(_this3.templateForm.attachmentFileDTOS);\n                _context5.prev = 13;\n\n                _iterator.s();\n\n              case 15:\n                if ((_step = _iterator.n()).done) {\n                  _context5.next = 24;\n                  break;\n                }\n\n                item = _step.value;\n                _context5.next = 19;\n                return globalService.deleteData_Async(administratorAPI.API_DeleteAttachmentFile(item.id));\n\n              case 19:\n                response = _context5.sent;\n\n                if (!(!response || !response.state)) {\n                  _context5.next = 22;\n                  break;\n                }\n\n                return _context5.abrupt(\"return\", _this3.toastError(response));\n\n              case 22:\n                _context5.next = 15;\n                break;\n\n              case 24:\n                _context5.next = 29;\n                break;\n\n              case 26:\n                _context5.prev = 26;\n                _context5.t0 = _context5[\"catch\"](13);\n\n                _iterator.e(_context5.t0);\n\n              case 29:\n                _context5.prev = 29;\n\n                _iterator.f();\n\n                return _context5.finish(29);\n\n              case 32:\n                _context5.next = 34;\n                return globalService.upload_Async(administratorAPI.API_UploadTemplateFileCloud(_this3.templateForm.id), event);\n\n              case 34:\n                response = _context5.sent;\n\n                if (response) {\n                  _context5.next = 38;\n                  break;\n                }\n\n                _this3.toastError(response);\n\n                return _context5.abrupt(\"return\");\n\n              case 38:\n                if (response.state) {\n                  _context5.next = 41;\n                  break;\n                }\n\n                _this3.toastError(response.messgage);\n\n                return _context5.abrupt(\"return\");\n\n              case 41:\n                if (!_this3.templateForm.attachmentFileDTOS) {\n                  _this3.templateForm.attachmentFileDTOS = [];\n                }\n\n                _this3.templateForm.attachmentFileDTOS.push(response.data);\n\n                _context5.next = 48;\n                break;\n\n              case 45:\n                _context5.prev = 45;\n                _context5.t1 = _context5[\"catch\"](10);\n\n                _this3.toastError(_context5.t1);\n\n              case 48:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, null, [[10, 45], [13, 26, 29, 32]]);\n      }))();\n    },\n    save: function save() {\n      var _this4 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6() {\n        var response;\n        return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                if (_this4.validRequiredText(_this4.templateForm.templateFormName)) {\n                  _context6.next = 2;\n                  break;\n                }\n\n                return _context6.abrupt(\"return\");\n\n              case 2:\n                _this4.templateForm.modified = _this4.getUserInfo();\n                _this4.templateForm.modifiedDate = new Date();\n                _this4.templateForm.modifiedName = _this4.getUserInfo().fullName;\n\n                if (!_this4.templateForm.id) {\n                  _this4.templateForm.created = _this4.getUserInfo();\n                  _this4.templateForm.createdDate = new Date();\n                  _this4.templateForm.createdName = _this4.getUserInfo().fullName;\n                }\n\n                _context6.prev = 6;\n\n                if (_this4.templateForm.id) {\n                  _context6.next = 13;\n                  break;\n                }\n\n                _context6.next = 10;\n                return globalService.postData_Async(administratorAPI.API_CreateTemplateForm(), _this4.templateForm);\n\n              case 10:\n                response = _context6.sent;\n                _context6.next = 16;\n                break;\n\n              case 13:\n                _context6.next = 15;\n                return globalService.putData_Async(administratorAPI.API_SaveTemplateForm(_this4.templateForm.id), _this4.templateForm);\n\n              case 15:\n                response = _context6.sent;\n\n              case 16:\n                if (response) {\n                  _context6.next = 19;\n                  break;\n                }\n\n                _this4.toastError(response);\n\n                return _context6.abrupt(\"return\", false);\n\n              case 19:\n                if (response.state) {\n                  _context6.next = 22;\n                  break;\n                }\n\n                _this4.toastError(response.messgage);\n\n                return _context6.abrupt(\"return\", false);\n\n              case 22:\n                _this4.templateForm = response.data;\n                return _context6.abrupt(\"return\", true);\n\n              case 26:\n                _context6.prev = 26;\n                _context6.t0 = _context6[\"catch\"](6);\n\n                _this4.toastError(_context6.t0);\n\n                return _context6.abrupt(\"return\", false);\n\n              case 30:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, null, [[6, 26]]);\n      }))();\n    },\n    delete: function _delete() {\n      var _this5 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7() {\n        var response;\n        return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                _context7.prev = 0;\n                _this5.templateForm.isDelete = true;\n                _context7.next = 4;\n                return globalService.putData_Async(administratorAPI.API_SaveTemplateForm(_this5.templateForm.id), _this5.templateForm);\n\n              case 4:\n                response = _context7.sent;\n\n                if (response) {\n                  _context7.next = 8;\n                  break;\n                }\n\n                _this5.toastError(response);\n\n                return _context7.abrupt(\"return\");\n\n              case 8:\n                if (response.state) {\n                  _context7.next = 11;\n                  break;\n                }\n\n                _this5.toastError(response.messgage);\n\n                return _context7.abrupt(\"return\");\n\n              case 11:\n                _this5.$router.push({\n                  path: \".\"\n                });\n\n                _context7.next = 17;\n                break;\n\n              case 14:\n                _context7.prev = 14;\n                _context7.t0 = _context7[\"catch\"](0);\n\n                _this5.toastError(_context7.t0);\n\n              case 17:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, null, [[0, 14]]);\n      }))();\n    },\n    back: function back() {\n      this.$router.push({\n        path: \"./\"\n      });\n    },\n    appendItem: function appendItem() {\n      this.creating = true;\n      this.editing = null;\n      this.mapping = {\n        name: \"\",\n        position: \"\"\n      };\n    },\n    add: function add() {\n      var temp = [];\n\n      try {\n        temp = JSON.parse(this.templateForm.mappingInfo);\n      } catch (error) {\n        temp = [];\n      }\n\n      temp.push(this.mapping);\n      this.templateForm.mappingInfo = JSON.stringify(temp);\n      this.mapping = {\n        name: \"\",\n        position: \"\"\n      };\n    },\n    edit: function edit(item) {\n      this.editing = item;\n      this.mapping = item;\n      this.creating = false;\n    },\n    update: function update() {\n      this.templateForm.mappingInfo = JSON.stringify(this.items);\n      this.creating = false;\n      this.editing = null;\n    },\n\n    /**\r\n     * @return {Array}\r\n     */\n    _items: function _items() {\n      try {\n        return JSON.parse(this.templateForm.mappingInfo);\n      } catch (error) {\n        return [];\n      }\n    },\n    deleteItem: function deleteItem(item) {\n      var items = this._items();\n\n      var index = items.indexOf(item);\n      items.splice(index, 1);\n      this.templateForm.mappingInfo = JSON.stringify(items);\n    },\n    openEdit: function openEdit() {\n      if (!this.templateForm.attachmentFileDTOS[0].ofice365Path) {\n        this.toastError(\"error.unavaiable\");\n        return;\n      }\n\n      window.open(this.templateForm.attachmentFileDTOS[0].ofice365Path, \"_blank\");\n    },\n    onChangeDelete: function onChangeDelete() {\n      var _this6 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8() {\n        var response, _iterator2, _step2, item;\n\n        return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                if (!_this6.templateForm.attachmentFileDTOS.length) {\n                  _context8.next = 21;\n                  break;\n                }\n\n                _iterator2 = _createForOfIteratorHelper(_this6.templateForm.attachmentFileDTOS);\n                _context8.prev = 2;\n\n                _iterator2.s();\n\n              case 4:\n                if ((_step2 = _iterator2.n()).done) {\n                  _context8.next = 13;\n                  break;\n                }\n\n                item = _step2.value;\n                _context8.next = 8;\n                return globalService.deleteData_Async(administratorAPI.API_DeleteAttachmentFile(item.id));\n\n              case 8:\n                response = _context8.sent;\n\n                if (!(!response || !response.state)) {\n                  _context8.next = 11;\n                  break;\n                }\n\n                return _context8.abrupt(\"return\", _this6.toastError(response));\n\n              case 11:\n                _context8.next = 4;\n                break;\n\n              case 13:\n                _context8.next = 18;\n                break;\n\n              case 15:\n                _context8.prev = 15;\n                _context8.t0 = _context8[\"catch\"](2);\n\n                _iterator2.e(_context8.t0);\n\n              case 18:\n                _context8.prev = 18;\n\n                _iterator2.f();\n\n                return _context8.finish(18);\n\n              case 21:\n                _this6.previewLink = \"\";\n\n              case 22:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, null, [[2, 15, 18, 21]]);\n      }))();\n    }\n  }\n};","map":{"version":3,"mappings":"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","names":["name","components","BreadcrumbsVue","TabVue","computed","items","watch","id","value","globalService","administratorAPI","response","data","tabs","key","title","buttons","icon","color","transparent","dark","event","templateForm","headers","text","align","sortable","creating","editing","mapping","position","previewLink","created","mounted","methods","initialize","path","handleButtonClick","handleFile","canUpload","console","item","save","delete","back","appendItem","add","temp","edit","update","_items","deleteItem","openEdit","window","onChangeDelete"],"sourceRoot":"src/views/modules/administrator/TemplateForm","sources":["EditTemplateFormV2.vue"],"sourcesContent":["<template>\r\n\t<v-card elevation=\"0\">\r\n\t\t<BreadcrumbsVue />\r\n\t\t<TabVue\r\n\t\t\t:tabs=\"tabs\"\r\n\t\t\t:buttons=\"buttons\"\r\n\t\t\t@buttonClick=\"handleButtonClick\"\r\n\t\t/>\r\n\t\t<v-row class=\"mt-4 px-4\">\r\n\t\t\t<v-col cols=\"12\" md=\"4\">\r\n\t\t\t\t<v-row>\r\n\t\t\t\t\t<v-col cols=\"12\">\r\n\t\t\t\t\t\t<m-text-field\r\n\t\t\t\t\t\t\t:label=\"$t('label.name')\"\r\n\t\t\t\t\t\t\t:value=\"templateForm.templateFormName\"\r\n\t\t\t\t\t\t\t@value=\"(v) => (templateForm.templateFormName = v)\"\r\n\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</v-col>\r\n\t\t\t\t\t<v-col cols=\"12\">\r\n\t\t\t\t\t\t<v-file-input\r\n\t\t\t\t\t\t\toutlined\r\n\t\t\t\t\t\t\tdense\r\n\t\t\t\t\t\t\tappend-icon=\"mdi-cloud-upload-outline\"\r\n\t\t\t\t\t\t\tprepend-icon=\"\"\r\n\t\t\t\t\t\t\t:label=\"$t('label.upload')\"\r\n\t\t\t\t\t\t\t@change=\"handleFile($event)\"\r\n\t\t\t\t\t\t\t@click:clear=\"onChangeDelete()\"\r\n\t\t\t\t\t\t></v-file-input>\r\n\t\t\t\t\t</v-col>\r\n\t\t\t\t</v-row>\r\n\t\t\t\t<v-row>\r\n\t\t\t\t\t<v-col cols=\"12\">\r\n\t\t\t\t\t\t<v-btn text class=\"rounded-0\" @click=\"appendItem()\">\r\n\t\t\t\t\t\t\t<v-icon> mdi-plus-circle </v-icon>\r\n\t\t\t\t\t\t\t{{ $t(\"button.create\") }}\r\n\t\t\t\t\t\t</v-btn>\r\n\t\t\t\t\t\t<v-btn text class=\"rounded-0\">\r\n\t\t\t\t\t\t\t<v-icon> mdi-trash-can-outline </v-icon>\r\n\t\t\t\t\t\t\t{{ $t(\"button.delete\") }}\r\n\t\t\t\t\t\t</v-btn>\r\n\t\t\t\t\t</v-col>\r\n\t\t\t\t</v-row>\r\n\t\t\t\t<v-divider></v-divider>\r\n\t\t\t\t<v-row>\r\n\t\t\t\t\t<v-col cols=\"12\">\r\n\t\t\t\t\t\t<v-data-table\r\n\t\t\t\t\t\t\tshow-select\r\n\t\t\t\t\t\t\thide-default-footer\r\n\t\t\t\t\t\t\t:headers=\"headers\"\r\n\t\t\t\t\t\t\t:items=\"items\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<template v-slot:[`item.action`]=\"{ item }\">\r\n\t\t\t\t\t\t\t\t<v-btn\r\n\t\t\t\t\t\t\t\t\ticon\r\n\t\t\t\t\t\t\t\t\tv-if=\"editing != item\"\r\n\t\t\t\t\t\t\t\t\t@click=\"edit(item)\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<v-icon>mdi-pencil-circle </v-icon>\r\n\t\t\t\t\t\t\t\t</v-btn>\r\n\t\t\t\t\t\t\t\t<v-btn icon v-else @click=\"update\">\r\n\t\t\t\t\t\t\t\t\t<v-icon>mdi-checkbox-marked-circle </v-icon>\r\n\t\t\t\t\t\t\t\t</v-btn>\r\n\t\t\t\t\t\t\t\t<v-btn icon @click=\"deleteItem(item)\">\r\n\t\t\t\t\t\t\t\t\t<v-icon>mdi-delete-circle </v-icon>\r\n\t\t\t\t\t\t\t\t</v-btn>\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t<template v-slot:[`item.name`]=\"{ item }\">\r\n\t\t\t\t\t\t\t\t<span v-if=\"editing != item\">\r\n\t\t\t\t\t\t\t\t\t{{ item.name }}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t<m-text-field\r\n\t\t\t\t\t\t\t\t\tv-else\r\n\t\t\t\t\t\t\t\t\t:label=\"$t('label.name')\"\r\n\t\t\t\t\t\t\t\t\t:value=\"mapping.name\"\r\n\t\t\t\t\t\t\t\t\t@value=\"(v) => (mapping.name = v)\"\r\n\t\t\t\t\t\t\t\t\tclass=\"mt-2\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t<template v-slot:[`item.position`]=\"{ item }\">\r\n\t\t\t\t\t\t\t\t<span v-if=\"editing != item\">\r\n\t\t\t\t\t\t\t\t\t{{ item.position }}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t<m-text-field\r\n\t\t\t\t\t\t\t\t\tv-else\r\n\t\t\t\t\t\t\t\t\t:label=\"$t('label.position_in_file')\"\r\n\t\t\t\t\t\t\t\t\t:value=\"mapping.position\"\r\n\t\t\t\t\t\t\t\t\t@value=\"(v) => (mapping.position = v)\"\r\n\t\t\t\t\t\t\t\t\tclass=\"mt-2\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t<template v-if=\"creating\" v-slot:[`body.append`]>\r\n\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t<td></td>\r\n\t\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t\t<m-text-field\r\n\t\t\t\t\t\t\t\t\t\t\t:label=\"$t('label.name')\"\r\n\t\t\t\t\t\t\t\t\t\t\t:value=\"mapping.name\"\r\n\t\t\t\t\t\t\t\t\t\t\t@value=\"(v) => (mapping.name = v)\"\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"mt-2\"\r\n\t\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t\t<m-text-field\r\n\t\t\t\t\t\t\t\t\t\t\t:label=\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t$t('label.position_in_file')\r\n\t\t\t\t\t\t\t\t\t\t\t\"\r\n\t\t\t\t\t\t\t\t\t\t\t:value=\"mapping.position\"\r\n\t\t\t\t\t\t\t\t\t\t\t@value=\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t(v) => (mapping.position = v)\r\n\t\t\t\t\t\t\t\t\t\t\t\"\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"mt-2\"\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t\t<v-btn icon @click=\"add\">\r\n\t\t\t\t\t\t\t\t\t\t\t<v-icon>mdi-plus-circle</v-icon>\r\n\t\t\t\t\t\t\t\t\t\t</v-btn>\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t</v-data-table>\r\n\t\t\t\t\t</v-col>\r\n\t\t\t\t</v-row>\r\n\t\t\t</v-col>\r\n\t\t\t<v-divider vertical></v-divider>\r\n\t\t\t<v-col cols=\"12\" md=\"8\">\r\n\t\t\t\t<v-skeleton-loader\r\n\t\t\t\t\tv-if=\"!previewLink\"\r\n\t\t\t\t\tclass=\"mx-auto\"\r\n\t\t\t\t\twidth=\"100%\"\r\n\t\t\t\t\ttype=\"card\"\r\n\t\t\t\t></v-skeleton-loader>\r\n\r\n\t\t\t\t<v-btn\r\n\t\t\t\t\tv-if=\"previewLink\"\r\n\t\t\t\t\tfab\r\n\t\t\t\t\tx-small\r\n\t\t\t\t\tcolor=\"blue darken-2\"\r\n\t\t\t\t\tdark\r\n\t\t\t\t\t@click=\"openEdit\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<v-icon>mdi-pencil</v-icon>\r\n\t\t\t\t</v-btn>\r\n\t\t\t\t<iframe\r\n\t\t\t\t\tv-if=\"previewLink\"\r\n\t\t\t\t\t:src=\"previewLink + '&amp;action=embedview'\"\r\n\t\t\t\t\twidth=\"100%\"\r\n\t\t\t\t\theight=\"750\"\r\n\t\t\t\t\t:title=\"templateForm.templateFormName\"\r\n\t\t\t\t\tclass=\"-mt-12\"\r\n\t\t\t\t\t>This is an embedded\r\n\t\t\t\t\t<a target=\"_blank\" href=\"https://office.com\"\r\n\t\t\t\t\t\t>Microsoft Office</a\r\n\t\t\t\t\t>\r\n\t\t\t\t\tdocument, powered by\r\n\t\t\t\t\t<a target=\"_blank\" href=\"https://office.com/webapps\"\r\n\t\t\t\t\t\t>Office</a\r\n\t\t\t\t\t>.</iframe\r\n\t\t\t\t>\r\n\t\t\t</v-col>\r\n\t\t</v-row>\r\n\t</v-card>\r\n</template>\r\n\r\n<script>\r\nimport BreadcrumbsVue from \"@/components/Breadcrumbs.vue\";\r\nimport TabVue from \"@/components/Tab.vue\";\r\nimport TemplateFormDto from \"@/models/template-form.dto\";\r\nimport globalService from \"@/services/global.service\";\r\nimport administratorAPI from \"../administrator.api\";\r\n\r\nexport default {\r\n\tname: \"EditTempalteFormV2Vue\",\r\n\tcomponents: { BreadcrumbsVue, TabVue },\r\n\tcomputed: {\r\n\t\titems() {\r\n\t\t\ttry {\r\n\t\t\t\treturn JSON.parse(this.templateForm.mappingInfo);\r\n\t\t\t} catch {\r\n\t\t\t\treturn [];\r\n\t\t\t}\r\n\t\t},\r\n\t},\r\n\twatch: {\r\n\t\t\"templateForm.attachmentFileDTOS\": async function (value) {\r\n\t\t\tlet response;\r\n\t\t\ttry {\r\n\t\t\t\tlet id = value[0].id;\r\n\t\t\t\tresponse = await globalService.getData_Async(\r\n\t\t\t\t\tadministratorAPI.API_GetPreviewLink(id),\r\n\t\t\t\t);\r\n\t\t\t\tif (!response || !response.state) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tthis.previewLink = response.data;\r\n\t\t\t} catch {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t},\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\ttabs: [{ key: \"information\", title: this.$t(\"label.information\") }],\r\n\t\t\tbuttons: [\r\n\t\t\t\t{\r\n\t\t\t\t\ticon: \"mdi-content-save\",\r\n\t\t\t\t\ttitle: this.$t(\"button.save\"),\r\n\t\t\t\t\tcolor: \"blue darken-2\",\r\n\t\t\t\t\ttransparent: false,\r\n\t\t\t\t\tdark: true,\r\n\t\t\t\t\tevent: this.save,\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ticon: \"mdi-trash-can-outline\",\r\n\t\t\t\t\ttitle: this.$t(\"button.delete\"),\r\n\t\t\t\t\tcolor: \"black\",\r\n\t\t\t\t\ttransparent: true,\r\n\t\t\t\t\tdark: false,\r\n\t\t\t\t\tevent: this.delete,\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ticon: \"mdi-arrow-left-top\",\r\n\t\t\t\t\ttitle: this.$t(\"button.back\"),\r\n\t\t\t\t\tcolor: \"black\",\r\n\t\t\t\t\ttransparent: true,\r\n\t\t\t\t\tdark: false,\r\n\t\t\t\t\tevent: this.back,\r\n\t\t\t\t},\r\n\t\t\t],\r\n\t\t\ttemplateForm: Object.assign({}, TemplateFormDto),\r\n\t\t\theaders: [\r\n\t\t\t\t{\r\n\t\t\t\t\ttext: this.$t(\"label.name\"),\r\n\t\t\t\t\talign: \"start\",\r\n\t\t\t\t\tvalue: \"name\",\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttext: this.$t(\"label.position_in_file\"),\r\n\t\t\t\t\talign: \"start\",\r\n\t\t\t\t\tvalue: \"position\",\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttext: this.$t(\"label.manipulation\"),\r\n\t\t\t\t\talign: \"start\",\r\n\t\t\t\t\tsortable: false,\r\n\t\t\t\t\tvalue: \"action\",\r\n\t\t\t\t},\r\n\t\t\t],\r\n\t\t\tcreating: false,\r\n\t\t\tediting: false,\r\n\t\t\tmapping: {\r\n\t\t\t\tname: \"\",\r\n\t\t\t\tposition: \"\",\r\n\t\t\t},\r\n\t\t\tpreviewLink: \"\",\r\n\t\t};\r\n\t},\r\n\tasync created() {\r\n\t\tawait this.initialize();\r\n\t},\r\n\tmounted() {},\r\n\tmethods: {\r\n\t\tasync initialize() {\r\n\t\t\tif (!this.$router.currentRoute.params.id) {\r\n\t\t\t\tthis.templateForm = Object.assign({}, TemplateFormDto);\r\n\t\t\t} else {\r\n\t\t\t\tlet response;\r\n\t\t\t\ttry {\r\n\t\t\t\t\tresponse = await globalService.getData_Async(\r\n\t\t\t\t\t\tadministratorAPI.API_GetTemplateForm(\r\n\t\t\t\t\t\t\tthis.$router.currentRoute.params.id,\r\n\t\t\t\t\t\t),\r\n\t\t\t\t\t);\r\n\t\t\t\t\tif (!response || !response.state) {\r\n\t\t\t\t\t\tthis.$router.push({ path: \"./\" });\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.templateForm = response.data;\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tthis.$router.push({ path: \"./\" });\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync handleButtonClick(event) {\r\n\t\t\tawait event();\r\n\t\t},\r\n\t\tasync handleFile(event) {\r\n\t\t\tif (!event) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet canUpload = true;\r\n\t\t\tif (!this.templateForm.id) {\r\n\t\t\t\tcanUpload = await this.save();\r\n\t\t\t}\r\n\t\t\tif (!canUpload) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconsole.log(\"event up\", event);\r\n\t\t\tlet response;\r\n\t\t\ttry {\r\n\t\t\t\tif (this.templateForm.attachmentFileDTOS.length) {\r\n\t\t\t\t\tfor (let item of this.templateForm.attachmentFileDTOS) {\r\n\t\t\t\t\t\tresponse = await globalService.deleteData_Async(\r\n\t\t\t\t\t\t\tadministratorAPI.API_DeleteAttachmentFile(item.id),\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tif (!response || !response.state) {\r\n\t\t\t\t\t\t\treturn this.toastError(response);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tresponse = await globalService.upload_Async(\r\n\t\t\t\t\tadministratorAPI.API_UploadTemplateFileCloud(\r\n\t\t\t\t\t\tthis.templateForm.id,\r\n\t\t\t\t\t),\r\n\t\t\t\t\tevent,\r\n\t\t\t\t);\r\n\t\t\t\tif (!response) {\r\n\t\t\t\t\tthis.toastError(response);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (!response.state) {\r\n\t\t\t\t\tthis.toastError(response.messgage);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (!this.templateForm.attachmentFileDTOS) {\r\n\t\t\t\t\tthis.templateForm.attachmentFileDTOS = [];\r\n\t\t\t\t}\r\n\t\t\t\tthis.templateForm.attachmentFileDTOS.push(response.data);\r\n\t\t\t} catch (error) {\r\n\t\t\t\tthis.toastError(error);\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync save() {\r\n\t\t\tif (!this.validRequiredText(this.templateForm.templateFormName)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.templateForm.modified = this.getUserInfo();\r\n\t\t\tthis.templateForm.modifiedDate = new Date();\r\n\t\t\tthis.templateForm.modifiedName = this.getUserInfo().fullName;\r\n\t\t\tif (!this.templateForm.id) {\r\n\t\t\t\tthis.templateForm.created = this.getUserInfo();\r\n\t\t\t\tthis.templateForm.createdDate = new Date();\r\n\t\t\t\tthis.templateForm.createdName = this.getUserInfo().fullName;\r\n\t\t\t}\r\n\t\t\tlet response;\r\n\t\t\ttry {\r\n\t\t\t\tif (!this.templateForm.id) {\r\n\t\t\t\t\tresponse = await globalService.postData_Async(\r\n\t\t\t\t\t\tadministratorAPI.API_CreateTemplateForm(),\r\n\t\t\t\t\t\tthis.templateForm,\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresponse = await globalService.putData_Async(\r\n\t\t\t\t\t\tadministratorAPI.API_SaveTemplateForm(\r\n\t\t\t\t\t\t\tthis.templateForm.id,\r\n\t\t\t\t\t\t),\r\n\t\t\t\t\t\tthis.templateForm,\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tif (!response) {\r\n\t\t\t\t\tthis.toastError(response);\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tif (!response.state) {\r\n\t\t\t\t\tthis.toastError(response.messgage);\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tthis.templateForm = response.data;\r\n\t\t\t\treturn true;\r\n\t\t\t} catch (error) {\r\n\t\t\t\tthis.toastError(error);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync delete() {\r\n\t\t\tlet response;\r\n\t\t\ttry {\r\n\t\t\t\tthis.templateForm.isDelete = true;\r\n\t\t\t\tresponse = await globalService.putData_Async(\r\n\t\t\t\t\tadministratorAPI.API_SaveTemplateForm(this.templateForm.id),\r\n\t\t\t\t\tthis.templateForm,\r\n\t\t\t\t);\r\n\t\t\t\tif (!response) {\r\n\t\t\t\t\tthis.toastError(response);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (!response.state) {\r\n\t\t\t\t\tthis.toastError(response.messgage);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tthis.$router.push({ path: \".\" });\r\n\t\t\t} catch (error) {\r\n\t\t\t\tthis.toastError(error);\r\n\t\t\t}\r\n\t\t},\r\n\t\tback() {\r\n\t\t\tthis.$router.push({ path: \"./\" });\r\n\t\t},\r\n\t\tappendItem() {\r\n\t\t\tthis.creating = true;\r\n\t\t\tthis.editing = null;\r\n\t\t\tthis.mapping = { name: \"\", position: \"\" };\r\n\t\t},\r\n\t\tadd() {\r\n\t\t\tlet temp = [];\r\n\t\t\ttry {\r\n\t\t\t\ttemp = JSON.parse(this.templateForm.mappingInfo);\r\n\t\t\t} catch (error) {\r\n\t\t\t\ttemp = [];\r\n\t\t\t}\r\n\t\t\ttemp.push(this.mapping);\r\n\t\t\tthis.templateForm.mappingInfo = JSON.stringify(temp);\r\n\t\t\tthis.mapping = { name: \"\", position: \"\" };\r\n\t\t},\r\n\t\tedit(item) {\r\n\t\t\tthis.editing = item;\r\n\t\t\tthis.mapping = item;\r\n\t\t\tthis.creating = false;\r\n\t\t},\r\n\t\tupdate() {\r\n\t\t\tthis.templateForm.mappingInfo = JSON.stringify(this.items);\r\n\t\t\tthis.creating = false;\r\n\t\t\tthis.editing = null;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * @return {Array}\r\n\t\t */\r\n\t\t_items() {\r\n\t\t\ttry {\r\n\t\t\t\treturn JSON.parse(this.templateForm.mappingInfo);\r\n\t\t\t} catch (error) {\r\n\t\t\t\treturn [];\r\n\t\t\t}\r\n\t\t},\r\n\t\tdeleteItem(item) {\r\n\t\t\tlet items = this._items();\r\n\t\t\tlet index = items.indexOf(item);\r\n\t\t\titems.splice(index, 1);\r\n\t\t\tthis.templateForm.mappingInfo = JSON.stringify(items);\r\n\t\t},\r\n\t\topenEdit() {\r\n\t\t\tif (!this.templateForm.attachmentFileDTOS[0].ofice365Path) {\r\n\t\t\t\tthis.toastError(\"error.unavaiable\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\twindow.open(\r\n\t\t\t\tthis.templateForm.attachmentFileDTOS[0].ofice365Path,\r\n\t\t\t\t\"_blank\",\r\n\t\t\t);\r\n\t\t},\r\n\t\tasync onChangeDelete() {\r\n\t\t\tlet response;\r\n\t\t\tif (this.templateForm.attachmentFileDTOS.length) {\r\n\t\t\t\tfor (let item of this.templateForm.attachmentFileDTOS) {\r\n\t\t\t\t\tresponse = await globalService.deleteData_Async(\r\n\t\t\t\t\t\tadministratorAPI.API_DeleteAttachmentFile(item.id),\r\n\t\t\t\t\t);\r\n\t\t\t\t\tif (!response || !response.state) {\r\n\t\t\t\t\t\treturn this.toastError(response);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.previewLink = \"\";\r\n\t\t},\r\n\t},\r\n};\r\n</script>\r\n\r\n<style></style>\r\n"]},"metadata":{},"sourceType":"module"}