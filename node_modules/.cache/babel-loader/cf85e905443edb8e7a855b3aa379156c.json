{"ast":null,"code":"import \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\n// we bubble up and down validation instructions from the top form to the lower fields and through each container levels\n// each intermediate level is aware of its validation state wich is useful in sections management, complex array, etc.\nimport { deepEqual } from 'fast-equals';\nexport default {\n  inject: ['form'],\n  provide: function provide() {\n    return {\n      form: {\n        register: this.register,\n        unregister: this.unregister,\n        fastForwardEvent: this.fastForwardEvent,\n        getExprNode: this.getExprNode\n      }\n    };\n  },\n  props: {\n    separateValidation: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data: function data() {\n    return {\n      inputs: [],\n      validated: false,\n      shouldValidate: false,\n      dedupChildrenWithValidatedErrors: []\n    };\n  },\n  computed: {\n    childrenInputs: function childrenInputs() {\n      return this.inputs.reduce(function (a, input, i) {\n        a[input.modelKey || i] = input;\n        return a;\n      }, {});\n    },\n    hasError: function hasError() {\n      return !!this.inputs.find(function (input) {\n        return input.hasError;\n      }) || !!this.localRuleError;\n    },\n    hasValidatedError: function hasValidatedError() {\n      return !!this.inputs.find(function (input) {\n        return input.hasValidatedError || input.hasError && (input.validated || input.shouldValidate);\n      }) || this.localRuleError && (this.validated || this.shouldValidate);\n    },\n    childrenWithValidatedErrors: function childrenWithValidatedErrors() {\n      var _this = this;\n\n      return Object.keys(this.childrenInputs).filter(function (key) {\n        return !!_this.childrenInputs[key].hasValidatedError;\n      });\n    },\n    localRuleError: function localRuleError() {\n      var _this2 = this;\n\n      if (!this.validated || !this.rules || !this.rules.length) return false;\n      var brokenRule = this.rules.find(function (rule) {\n        return typeof rule(_this2.value) === 'string';\n      });\n      return brokenRule && brokenRule(this.value);\n    }\n  },\n  watch: {\n    childrenWithValidatedErrors: function childrenWithValidatedErrors() {\n      var _this3 = this;\n\n      // the \"dedup version\" is there only to trigger less renderings\n      // nextTick prevents some hard to debug infinite loops\n      this.$nextTick(function () {\n        if (!deepEqual(_this3.childrenWithValidatedErrors, _this3.dedupChildrenWithValidatedErrors)) {\n          _this3.dedupChildrenWithValidatedErrors = _this3.childrenWithValidatedErrors;\n        }\n      });\n    }\n  },\n  created: function created() {\n    if (!this.separateValidation) this.form && this.form.register(this);\n  },\n  beforeDestroy: function beforeDestroy() {\n    if (!this.separateValidation) this.form && this.form.unregister(this);\n  },\n  methods: {\n    register: function register(input) {\n      if (this.validated) input.validate(true);\n      this.inputs.push(input);\n    },\n    unregister: function unregister(input) {\n      this.inputs = this.inputs.filter(function (i) {\n        return i._uid !== input._uid;\n      });\n    },\n    validate: function validate(force) {\n      this.validated = true;\n      var results = this.inputs.map(function (input, i) {\n        return {\n          valid: input.validate(force),\n          key: input.modelKey || i\n        };\n      });\n      return !results.find(function (r) {\n        return !r.valid;\n      });\n    },\n    reset: function reset() {\n      this.inputs.forEach(function (input) {\n        return input.reset();\n      });\n    },\n    resetValidation: function resetValidation() {\n      this.shouldValidate = false;\n      this.validated = false;\n      this.inputs.forEach(function (input) {\n        return input.resetValidation();\n      });\n    },\n    initValidation: function initValidation() {\n      var initialValidation = this.fullOptions.initialValidation;\n\n      if (initialValidation === 'all' && !this.modelRoot) {\n        this.validate(true);\n      }\n\n      if (initialValidation === 'defined' && this.initiallyDefined && !this.isObjectContainer) {\n        this.validate(true);\n      }\n    },\n    fastForwardEvent: function fastForwardEvent(eventName, data) {\n      // emit an event to the top of the vjsf instances tree exactly as it is\n      if (this.fullKey === 'root') this.$emit(eventName, data);else this.form.fastForwardEvent(eventName, data);\n    },\n    getExprNode: function getExprNode() {\n      var node = {\n        value: this.value,\n        key: this.modelKey,\n        fullKey: this.fullKey\n      };\n      if (this.form && this.form.getExprNode) node.parent = this.form.getExprNode();\n      return node;\n    }\n  }\n};","map":{"version":3,"names":["deepEqual","inject","provide","form","register","unregister","fastForwardEvent","getExprNode","props","separateValidation","type","Boolean","default","data","inputs","validated","shouldValidate","dedupChildrenWithValidatedErrors","computed","childrenInputs","reduce","a","input","i","modelKey","hasError","find","localRuleError","hasValidatedError","childrenWithValidatedErrors","Object","keys","filter","key","rules","length","brokenRule","rule","value","watch","$nextTick","created","beforeDestroy","methods","validate","push","_uid","force","results","map","valid","r","reset","forEach","resetValidation","initValidation","initialValidation","fullOptions","modelRoot","initiallyDefined","isObjectContainer","eventName","fullKey","$emit","node","parent"],"sources":["C:/Users/nam/OneDrive/Máy tính/New folder/node_modules/@koumoul/vjsf/lib/mixins/Validatable.js"],"sourcesContent":["// we bubble up and down validation instructions from the top form to the lower fields and through each container levels\n// each intermediate level is aware of its validation state wich is useful in sections management, complex array, etc.\nimport { deepEqual } from 'fast-equals'\n\nexport default {\n  inject: ['form'],\n  provide() {\n    return {\n      form: {\n        register: this.register,\n        unregister: this.unregister,\n        fastForwardEvent: this.fastForwardEvent,\n        getExprNode: this.getExprNode\n      }\n    }\n  },\n  props: {\n    separateValidation: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data() {\n    return {\n      inputs: [],\n      validated: false,\n      shouldValidate: false,\n      dedupChildrenWithValidatedErrors: []\n    }\n  },\n  computed: {\n    childrenInputs() {\n      return this.inputs.reduce((a, input, i) => { a[input.modelKey || i] = input; return a }, {})\n    },\n    hasError() {\n      return !!this.inputs.find(input => input.hasError) || !!this.localRuleError\n    },\n    hasValidatedError() {\n      return !!this.inputs.find(input => input.hasValidatedError || (input.hasError && (input.validated || input.shouldValidate))) ||\n        (this.localRuleError && (this.validated || this.shouldValidate))\n    },\n    childrenWithValidatedErrors() {\n      return Object.keys(this.childrenInputs).filter(key => !!this.childrenInputs[key].hasValidatedError)\n    },\n    localRuleError() {\n      if (!this.validated || !this.rules || !this.rules.length) return false\n      const brokenRule = this.rules.find(rule => {\n        return typeof rule(this.value) === 'string'\n      })\n      return brokenRule && brokenRule(this.value)\n    }\n  },\n  watch: {\n    childrenWithValidatedErrors() {\n      // the \"dedup version\" is there only to trigger less renderings\n      // nextTick prevents some hard to debug infinite loops\n      this.$nextTick(() => {\n        if (!deepEqual(this.childrenWithValidatedErrors, this.dedupChildrenWithValidatedErrors)) {\n          this.dedupChildrenWithValidatedErrors = this.childrenWithValidatedErrors\n        }\n      })\n    }\n  },\n  created () {\n    if (!this.separateValidation) this.form && this.form.register(this)\n  },\n  beforeDestroy () {\n    if (!this.separateValidation) this.form && this.form.unregister(this)\n  },\n  methods: {\n    register(input) {\n      if (this.validated) input.validate(true)\n      this.inputs.push(input)\n    },\n    unregister(input) {\n      this.inputs = this.inputs.filter(i => i._uid !== input._uid)\n    },\n    validate(force) {\n      this.validated = true\n      const results = this.inputs.map((input, i) => ({\n        valid: input.validate(force),\n        key: input.modelKey || i\n      }))\n      return !results.find(r => !r.valid)\n    },\n    reset() {\n      this.inputs.forEach(input => input.reset())\n    },\n    resetValidation() {\n      this.shouldValidate = false\n      this.validated = false\n      this.inputs.forEach(input => input.resetValidation())\n    },\n    initValidation() {\n      const initialValidation = this.fullOptions.initialValidation\n      if (initialValidation === 'all' && !this.modelRoot) {\n        this.validate(true)\n      }\n      if (initialValidation === 'defined' && this.initiallyDefined && !this.isObjectContainer) {\n        this.validate(true)\n      }\n    },\n    fastForwardEvent(eventName, data) {\n      // emit an event to the top of the vjsf instances tree exactly as it is\n      if (this.fullKey === 'root') this.$emit(eventName, data)\n      else this.form.fastForwardEvent(eventName, data)\n    },\n    getExprNode() {\n      const node = {\n        value: this.value,\n        key: this.modelKey,\n        fullKey: this.fullKey\n      }\n      if (this.form && this.form.getExprNode) node.parent = this.form.getExprNode()\n      return node\n    }\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}