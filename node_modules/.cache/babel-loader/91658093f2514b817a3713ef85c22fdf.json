{"ast":null,"code":"import _createForOfIteratorHelper from \"C:/Users/nam/OneDrive/M\\xE1y t\\xEDnh/New folder/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _regeneratorRuntime from \"C:/Users/nam/OneDrive/M\\xE1y t\\xEDnh/New folder/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/nam/OneDrive/M\\xE1y t\\xEDnh/New folder/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.from.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.array.splice.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport globalService from \"@/services/global.service\";\nimport administratorAPI from \"../../administrator/administrator.api\";\nimport ApproveDto from \"@/models/approve.dto\";\nimport constant from \"@/common/constant\";\nexport default {\n  name: \"VsmFeDigitalSignrequestform\",\n  menu: false,\n  props: {\n    request: {}\n  },\n  watch: {\n    request: function request(newValue) {\n      this.m_requestData = newValue;\n      console.log(\"this.m_requestData\", this.m_requestData);\n    }\n  },\n  data: function data() {\n    return {\n      expiryDate: \"\",\n      file: null,\n      m_requestData: null,\n      approveRequestDto: ApproveDto,\n      user_info: this.getUserInfo(),\n      attachmentFiles: [],\n      files: {},\n      listSignture: []\n    };\n  },\n  mounted: function mounted() {},\n  created: function created() {\n    this.m_requestData = this.request;\n    console.log(\"this.m_requestData\", this.m_requestData);\n  },\n  methods: {\n    close: function close() {\n      this.$emit(\"close\", true);\n    },\n    handleFileUpload: function handleFileUpload(event) {\n      this.file = event;\n    },\n    approveRequest: function approveRequest() {\n      var _this = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var response;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                console.log(\"Trình phê duyệt\");\n                console.log(\"this.m_requestData\", _this.m_requestData);\n                _this.approveRequestDto.action = \"Approve\"; //this.approveRequestDto.attachmentFileId = this.formData.isActive;\n\n                _this.approveRequestDto.errorMessageReturn = \"Thất bại\";\n                _this.approveRequestDto.requestDataId = _this.m_requestData.id; //this.approveRequestDto.statusId = \"\";\n\n                _this.approveRequestDto.successMessageReturn = \"Thành công\";\n                _this.approveRequestDto.userId = _this.user_info.id;\n                _context.next = 9;\n                return globalService.postData_Async(administratorAPI.API_Approve(), _this.approveRequestDto);\n\n              case 9:\n                response = _context.sent;\n\n                _this.toastSuccess(\"Phê duyệt phiếu thành công\");\n\n                _this.$emit(\"close\", true);\n\n                _this.$router.push({\n                  path: \"/phieu-yeu-cau/list-request-handle\"\n                });\n\n                if (!response || !response.state) {\n                  _this.toastError(_this.$t(\"error.load\"));\n                }\n\n              case 14:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }))();\n    },\n    handleFile: function handleFile(files) {\n      console.log(\"files: \", files);\n      this.files = Array.from(files.target.files);\n      console.log(\"files: \", this.files);\n    },\n    onDrop: function onDrop(event) {\n      event.preventDefault();\n      this.isDragOver = false;\n\n      if (event.dataTransfer) {\n        this.files = Array.from(event.dataTransfer.files);\n      }\n    },\n    onDragEnd: function onDragEnd(event) {\n      event.preventDefault();\n      this.isDragOver = false;\n    },\n    onDragEnter: function onDragEnter(event) {\n      event.preventDefault();\n      this.isDragOver = true;\n    },\n    onDragLeave: function onDragLeave(event) {\n      event.preventDefault();\n      this.isDragOver = false;\n    },\n    onDragOver: function onDragOver(event) {\n      event.preventDefault();\n      this.isDragOver = true;\n    },\n    onClick: function onClick(event) {\n      event.preventDefault();\n      var files = document.getElementById(constant.keys.files);\n      files.click();\n    },\n    remove: function remove(file) {\n      var index = this.files.indexOf(file);\n      this.files.splice(index, 1);\n    },\n    upload: function upload() {\n      var _this2 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var response, _iterator, _step, file;\n\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (_this2.files) {\n                  _context2.next = 2;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\");\n\n              case 2:\n                _context2.prev = 2;\n                _iterator = _createForOfIteratorHelper(_this2.files);\n                _context2.prev = 4;\n\n                _iterator.s();\n\n              case 6:\n                if ((_step = _iterator.n()).done) {\n                  _context2.next = 22;\n                  break;\n                }\n\n                file = _step.value;\n                console.log(\"file\", file);\n                console.log(\"this.requestData: \", _this2.requestData);\n                _context2.next = 12;\n                return globalService.uploadData_Async(administratorAPI.API_UploadFile365(), file, {\n                  parentItemId: _this2.requestData.idDirectoryPath,\n                  userId: _this2.userInfo.id,\n                  requestDataId: _this2.requestData.id\n                });\n\n              case 12:\n                response = _context2.sent;\n\n                if (response) {\n                  _context2.next = 15;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", _this2.toastError(_this2.$t(\"error.upload_file\")));\n\n              case 15:\n                if (response.state) {\n                  _context2.next = 17;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", _this2.toastError(response.message));\n\n              case 17:\n                _this2.attachmentFiles.push(response.data);\n\n                console.log(\"response file\", response);\n                _this2.files = []; //this.$emit(constant.keys.upload, true);\n\n              case 20:\n                _context2.next = 6;\n                break;\n\n              case 22:\n                _context2.next = 27;\n                break;\n\n              case 24:\n                _context2.prev = 24;\n                _context2.t0 = _context2[\"catch\"](4);\n\n                _iterator.e(_context2.t0);\n\n              case 27:\n                _context2.prev = 27;\n\n                _iterator.f();\n\n                return _context2.finish(27);\n\n              case 30:\n                _this2.$emit(\"save\", _this2.attachmentFiles);\n\n                _this2.closeDialog();\n\n                _context2.next = 37;\n                break;\n\n              case 34:\n                _context2.prev = 34;\n                _context2.t1 = _context2[\"catch\"](2);\n\n                _this2.toastError(_context2.t1);\n\n              case 37:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, null, [[2, 34], [4, 24, 27, 30]]);\n      }))();\n    }\n  }\n};","map":{"version":3,"mappings":"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","names":["name","menu","props","request","watch","newValue","console","data","expiryDate","file","m_requestData","approveRequestDto","user_info","attachmentFiles","files","listSignture","mounted","created","methods","close","handleFileUpload","event","approveRequest","globalService","administratorAPI","response","path","handleFile","onDrop","onDragEnd","onDragEnter","onDragLeave","onDragOver","onClick","remove","upload","parentItemId","userId","requestDataId"],"sourceRoot":"src/views/modules/khai-phieu-yeu-cau/modulepopup","sources":["DigitalSignRequestForm.vue"],"sourcesContent":["<template>\r\n\t<v-card elevation=\"0\" ref=\"form\">\r\n\t\t<v-toolbar flat color=\"grey lighten-4\">\r\n\t\t\t<v-toolbar-title>\r\n\t\t\t\t{{ $t(\"label.is_required_signature\") }}\r\n\t\t\t</v-toolbar-title>\r\n\t\t\t<v-spacer></v-spacer>\r\n\t\t\t<v-btn icon @click=\"close\">\r\n\t\t\t\t<v-icon>mdi-close</v-icon>\r\n\t\t\t</v-btn>\r\n\t\t</v-toolbar>\r\n\t\t<v-card-text class=\"white\">\r\n\t\t\t<v-container>\r\n\t\t\t\t<v-form v-model=\"valid\">\r\n\t\t\t\t\t<v-row>\r\n\t\t\t\t\t\t<v-col cols=\"12\" sm=\"12\" md=\"12\">\r\n\t\t\t\t\t\t\t<v-textarea\r\n\t\t\t\t\t\t\t\tdense\r\n\t\t\t\t\t\t\t\toutlined\r\n\t\t\t\t\t\t\t\tv-model=\"approveRequestDto.reason\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<template v-slot:label>\r\n\t\t\t\t\t\t\t\t\t{{ $t(\"label.mail_template_content\") }}\r\n\t\t\t\t\t\t\t\t\t<span class=\"text-red\">\r\n\t\t\t\t\t\t\t\t\t\t{{ $t(\"label.star\") }}\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t</v-textarea>\r\n\t\t\t\t\t\t</v-col>\r\n\t\t\t\t\t\t<v-col cols=\"12\" sm=\"12\" md=\"12\">\r\n\t\t\t\t\t\t\t<v-select\r\n\t\t\t\t\t\t\t\t:items=\"listSignture\"\r\n\t\t\t\t\t\t\t\t:label=\"$t('label.select_digital_signture')\"\r\n\t\t\t\t\t\t\t\toutlined\r\n\t\t\t\t\t\t\t\tdense\r\n\t\t\t\t\t\t\t></v-select>\r\n\t\t\t\t\t\t</v-col>\r\n\t\t\t\t\t\t<v-col cols=\"12\" sm=\"12\" md=\"12\">\r\n\t\t\t\t\t\t\t<v-text-field\r\n\t\t\t\t\t\t\t\t:label=\"$t('label.rental_code_phone_number')\"\r\n\t\t\t\t\t\t\t\toutlined\r\n\t\t\t\t\t\t\t\tdense\r\n\t\t\t\t\t\t\t></v-text-field>\r\n\t\t\t\t\t\t</v-col>\r\n\t\t\t\t\t\t<v-col cols=\"12\" sm=\"12\" md=\"12\">\r\n\t\t\t\t\t\t\t<m-date-picker\r\n\t\t\t\t\t\t\t\t:label=\"$t('label.expiry_date')\"\r\n\t\t\t\t\t\t\t\t:value=\"expiryDate\"\r\n\t\t\t\t\t\t\t\tformat=\"DD/MM/yyyy\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t</m-date-picker>\r\n\t\t\t\t\t\t</v-col>\r\n\t\t\t\t\t\t<!-- <v-col cols=\"12\" sm=\"12\" md=\"12\">\r\n\t\t\t\t\t\t\t<v-file-input\r\n\t\t\t\t\t\t\t\tref=\"file\"\r\n\t\t\t\t\t\t\t\t:label=\"$t('label.attachment_file')\"\r\n\t\t\t\t\t\t\t\toutlined\r\n\t\t\t\t\t\t\t\tdense\r\n\t\t\t\t\t\t\t\t@change=\"handleFileUpload($event)\"\r\n\t\t\t\t\t\t\t\t:error-messages=\"errorMessageFile\"\r\n\t\t\t\t\t\t\t\tchips\r\n\t\t\t\t\t\t\t\tmultiple\r\n\t\t\t\t\t\t\t\tsmall-chips\r\n\t\t\t\t\t\t\t\ttruncate-length=\"20\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t</v-file-input>\r\n\t\t\t\t\t\t</v-col> -->\r\n\t\t\t\t\t\t<v-col cols=\"12\" sm=\"12\" md=\"12\" style=\"padding: 0\">\r\n\t\t\t\t\t\t\t<v-card-text style=\"padding: 0\">\r\n\t\t\t\t\t\t\t\t<v-container class=\"mt-4 p-0\">\r\n\t\t\t\t\t\t\t\t\t<v-card\r\n\t\t\t\t\t\t\t\t\t\televation=\"0\"\r\n\t\t\t\t\t\t\t\t\t\tdropzone\r\n\t\t\t\t\t\t\t\t\t\t:class=\"\r\n\t\t\t\t\t\t\t\t\t\t\t!isDragOver\r\n\t\t\t\t\t\t\t\t\t\t\t\t? ''\r\n\t\t\t\t\t\t\t\t\t\t\t\t: 'background-active'\r\n\t\t\t\t\t\t\t\t\t\t\"\r\n\t\t\t\t\t\t\t\t\t\tclass=\"w-40 items-center p-0\"\r\n\t\t\t\t\t\t\t\t\t\t@drop=\"onDrop($event)\"\r\n\t\t\t\t\t\t\t\t\t\t@dragenter=\"onDragEnter($event)\"\r\n\t\t\t\t\t\t\t\t\t\t@dragleave=\"onDragLeave($event)\"\r\n\t\t\t\t\t\t\t\t\t\t@dragover=\"onDragOver($event)\"\r\n\t\t\t\t\t\t\t\t\t\t@dragend=\"onDragEnd($event)\"\r\n\t\t\t\t\t\t\t\t\t\t@click=\"onClick($event)\"\r\n\t\t\t\t\t\t\t\t\t\tstyle=\"box-sizing: border-box\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"d-flex justify-space-between border-2 px-2\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<v-card-text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{{ $t(\"Tải lên\") }}\r\n\t\t\t\t\t\t\t\t\t\t\t</v-card-text>\r\n\t\t\t\t\t\t\t\t\t\t\t<v-divider vertical></v-divider>\r\n\t\t\t\t\t\t\t\t\t\t\t<v-icon x-large class=\"ml-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>mdi-cloud-upload-outline\r\n\t\t\t\t\t\t\t\t\t\t\t</v-icon>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</v-card>\r\n\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\tref=\"files\"\r\n\t\t\t\t\t\t\t\t\t\tid=\"files\"\r\n\t\t\t\t\t\t\t\t\t\ttype=\"file\"\r\n\t\t\t\t\t\t\t\t\t\taccept=\".xlsx,.xls,image/*,.doc, .docx,.ppt, .pptx,.txt,.pdf\"\r\n\t\t\t\t\t\t\t\t\t\tclass=\"d-none\"\r\n\t\t\t\t\t\t\t\t\t\tmultiple\r\n\t\t\t\t\t\t\t\t\t\t@change=\"handleFile($event)\"\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t<VuePerfectScrollbar class=\"h-60\">\r\n\t\t\t\t\t\t\t\t\t\t<v-list>\r\n\t\t\t\t\t\t\t\t\t\t\t<v-list-item\r\n\t\t\t\t\t\t\t\t\t\t\t\tv-for=\"file in files\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t:key=\"file.name\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<v-list-item-icon>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<v-icon>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tm_files_icon[\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfile.type\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</v-icon>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</v-list-item-icon>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<v-list-item-content>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<v-list-item-title>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ file.name }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<v-icon\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"red darken-2\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tremove(file)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmdi-close-circle\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</v-icon>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</v-list-item-title>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</v-list-item-content>\r\n\t\t\t\t\t\t\t\t\t\t\t</v-list-item>\r\n\t\t\t\t\t\t\t\t\t\t</v-list>\r\n\t\t\t\t\t\t\t\t\t</VuePerfectScrollbar>\r\n\t\t\t\t\t\t\t\t</v-container>\r\n\t\t\t\t\t\t\t</v-card-text>\r\n\t\t\t\t\t\t</v-col>\r\n\t\t\t\t\t</v-row>\r\n\t\t\t\t</v-form>\r\n\t\t\t</v-container>\r\n\t\t</v-card-text>\r\n\t\t<v-card-actions class=\"white\">\r\n\t\t\t<v-spacer></v-spacer>\r\n\t\t\t<v-btn\r\n\t\t\t\tcolor=\"blue darken-1\"\r\n\t\t\t\televation=\"0\"\r\n\t\t\t\tdark\r\n\t\t\t\t@click=\"approveRequest()\"\r\n\t\t\t>\r\n\t\t\t\t{{ $t(\"button.ok\") }}\r\n\t\t\t</v-btn>\r\n\t\t\t<v-btn color=\"grey lighten-4\" elevation=\"0\" @click=\"close\">\r\n\t\t\t\t{{ $t(\"button.cancel\") }}\r\n\t\t\t</v-btn>\r\n\t\t</v-card-actions>\r\n\t</v-card>\r\n</template>\r\n\r\n<script>\r\nimport globalService from \"@/services/global.service\";\r\nimport administratorAPI from \"../../administrator/administrator.api\";\r\nimport ApproveDto from \"@/models/approve.dto\";\r\nimport constant from \"@/common/constant\";\r\n\r\nexport default {\r\n\tname: \"VsmFeDigitalSignrequestform\",\r\n\tmenu: false,\r\n\tprops: { request: {} },\r\n\twatch: {\r\n\t\trequest(newValue) {\r\n\t\t\tthis.m_requestData = newValue;\r\n\t\t\tconsole.log(\"this.m_requestData\", this.m_requestData);\r\n\t\t},\r\n\t},\r\n\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\texpiryDate: \"\",\r\n\t\t\tfile: null,\r\n\t\t\tm_requestData: null,\r\n\t\t\tapproveRequestDto: ApproveDto,\r\n\t\t\tuser_info: this.getUserInfo(),\r\n\t\t\tattachmentFiles: [],\r\n\t\t\tfiles: {},\r\n\t\t\tlistSignture: [],\r\n\t\t};\r\n\t},\r\n\r\n\tmounted() {},\r\n\tcreated() {\r\n\t\tthis.m_requestData = this.request;\r\n\t\tconsole.log(\"this.m_requestData\", this.m_requestData);\r\n\t},\r\n\r\n\tmethods: {\r\n\t\tclose() {\r\n\t\t\tthis.$emit(\"close\", true);\r\n\t\t},\r\n\t\thandleFileUpload(event) {\r\n\t\t\tthis.file = event;\r\n\t\t},\r\n\t\tasync approveRequest() {\r\n\t\t\tconsole.log(\"Trình phê duyệt\");\r\n\t\t\tconsole.log(\"this.m_requestData\", this.m_requestData);\r\n\r\n\t\t\tlet response;\r\n\t\t\tthis.approveRequestDto.action = \"Approve\";\r\n\t\t\t//this.approveRequestDto.attachmentFileId = this.formData.isActive;\r\n\t\t\tthis.approveRequestDto.errorMessageReturn = \"Thất bại\";\r\n\t\t\tthis.approveRequestDto.requestDataId = this.m_requestData.id;\r\n\t\t\t//this.approveRequestDto.statusId = \"\";\r\n\t\t\tthis.approveRequestDto.successMessageReturn = \"Thành công\";\r\n\t\t\tthis.approveRequestDto.userId = this.user_info.id;\r\n\t\t\tresponse = await globalService.postData_Async(\r\n\t\t\t\tadministratorAPI.API_Approve(),\r\n\t\t\t\tthis.approveRequestDto,\r\n\t\t\t);\r\n\t\t\tthis.toastSuccess(\"Phê duyệt phiếu thành công\");\r\n\t\t\tthis.$emit(\"close\", true);\r\n\t\t\tthis.$router.push({\r\n\t\t\t\tpath: `/phieu-yeu-cau/list-request-handle`,\r\n\t\t\t});\r\n\r\n\t\t\tif (!response || !response.state) {\r\n\t\t\t\tthis.toastError(this.$t(\"error.load\"));\r\n\t\t\t}\r\n\t\t},\r\n\t\thandleFile(files) {\r\n\t\t\tconsole.log(\"files: \", files);\r\n\t\t\tthis.files = Array.from(files.target.files);\r\n\t\t\tconsole.log(\"files: \", this.files);\r\n\t\t},\r\n\t\tonDrop(event) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tthis.isDragOver = false;\r\n\t\t\tif (event.dataTransfer) {\r\n\t\t\t\tthis.files = Array.from(event.dataTransfer.files);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonDragEnd(event) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tthis.isDragOver = false;\r\n\t\t},\r\n\t\tonDragEnter(event) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tthis.isDragOver = true;\r\n\t\t},\r\n\t\tonDragLeave(event) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tthis.isDragOver = false;\r\n\t\t},\r\n\t\tonDragOver(event) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tthis.isDragOver = true;\r\n\t\t},\r\n\t\tonClick(event) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tlet files = document.getElementById(constant.keys.files);\r\n\t\t\tfiles.click();\r\n\t\t},\r\n\t\tremove(file) {\r\n\t\t\tlet index = this.files.indexOf(file);\r\n\t\t\tthis.files.splice(index, 1);\r\n\t\t},\r\n\t\tasync upload() {\r\n\t\t\tif (!this.files) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet response;\r\n\t\t\ttry {\r\n\t\t\t\tfor (let file of this.files) {\r\n\t\t\t\t\tconsole.log(\"file\", file);\r\n\t\t\t\t\tconsole.log(\"this.requestData: \", this.requestData);\r\n\t\t\t\t\tresponse = await globalService.uploadData_Async(\r\n\t\t\t\t\t\tadministratorAPI.API_UploadFile365(),\r\n\t\t\t\t\t\tfile,\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tparentItemId: this.requestData.idDirectoryPath,\r\n\t\t\t\t\t\t\tuserId: this.userInfo.id,\r\n\t\t\t\t\t\t\trequestDataId: this.requestData.id,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t);\r\n\t\t\t\t\tif (!response) {\r\n\t\t\t\t\t\treturn this.toastError(this.$t(\"error.upload_file\"));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!response.state) {\r\n\t\t\t\t\t\treturn this.toastError(response.message);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.attachmentFiles.push(response.data);\r\n\t\t\t\t\tconsole.log(\"response file\", response);\r\n\t\t\t\t\tthis.files = [];\r\n\t\t\t\t\t//this.$emit(constant.keys.upload, true);\r\n\t\t\t\t}\r\n\t\t\t\tthis.$emit(\"save\", this.attachmentFiles);\r\n\t\t\t\tthis.closeDialog();\r\n\t\t\t} catch (error) {\r\n\t\t\t\tthis.toastError(error);\r\n\t\t\t}\r\n\t\t},\r\n\t},\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped></style>\r\n"]},"metadata":{},"sourceType":"module"}