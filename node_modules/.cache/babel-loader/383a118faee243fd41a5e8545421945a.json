{"ast":null,"code":"import _createForOfIteratorHelper from \"C:/Users/nam/OneDrive/M\\xE1y t\\xEDnh/New folder/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _regeneratorRuntime from \"C:/Users/nam/OneDrive/M\\xE1y t\\xEDnh/New folder/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/nam/OneDrive/M\\xE1y t\\xEDnh/New folder/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.string.trim.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.splice.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.find.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport globalService from \"@/services/global.service\";\nimport administratorAPI from \"../administrator.api\";\nimport CategoryDataDto from \"@/models/category-data.dto\";\nimport constant from \"@/common/constant\";\nimport CategoryGroupDTO from \"@/models/category-group.dto\";\nexport default {\n  name: \"EditCategoryVue\",\n  props: [\"categoryGroupDto\", \"categoryGroupDtos\", \"edit\"],\n  watch: {\n    edit: function edit(value) {\n      this.m_CategoryGroupDto = CategoryGroupDTO; // this.$refs.form.reset();\n\n      console.log(value);\n    },\n    categoryGroupDto: function categoryGroupDto(value) {\n      this.$refs.form.reset();\n      this.m_update(value);\n    },\n    categoryGroupDtos: function categoryGroupDtos(value) {\n      this.categoryGroups = value;\n    }\n  },\n  components: {},\n  data: function data() {\n    return {\n      errorName: \"\",\n      is_edit: false,\n      categoryGroupId: false,\n      validCategoryGroup: false,\n      validCategoryData: true,\n      loading: true,\n      dialogDelete: false,\n      search: \"\",\n      m_CategoryGroupDto: CategoryGroupDTO,\n      categoryDataDto: CategoryDataDto,\n      selected: [],\n      editedIndex: -1,\n      items: [],\n      parentItems: [],\n      categoryGroups: [],\n      categoryGroupParent: null,\n      globalFilterValue: null,\n      errName: \"\",\n      descriptionError: \"\"\n    };\n  },\n  created: function created() {},\n  mounted: function mounted() {\n    var _this = this;\n\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _this.$refs.form.reset();\n\n              _context.next = 3;\n              return _this.initialize();\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }))();\n  },\n  methods: {\n    initialize: function initialize() {\n      var _this2 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var response;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _this2.m_update(_this2.categoryGroupDto);\n\n                _context2.prev = 1;\n\n                if (_this2.$router.currentRoute.params) {\n                  _context2.next = 4;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", _this2.finishLoad());\n\n              case 4:\n                _this2.categoryGroupId = _this2.$router.currentRoute.params.id;\n\n                if (_this2.categoryGroupId) {\n                  _context2.next = 7;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\");\n\n              case 7:\n                _context2.next = 9;\n                return globalService.getData_Async(administratorAPI.API_GetCategoryGroup(_this2.categoryGroupId));\n\n              case 9:\n                response = _context2.sent;\n\n                if (response) {\n                  _context2.next = 12;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", _this2.toastError(_this2.$t(\"error.load\")));\n\n              case 12:\n                if (response.state) {\n                  _context2.next = 14;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", _this2.toastError(_this2.$t(\"error.load\")));\n\n              case 14:\n                _this2.m_CategoryGroupDto = response.data;\n\n                if (!(!_this2.m_CategoryGroupDto || !_this2.m_CategoryGroupDto.parent || !_this2.m_CategoryGroupDto.parent.id)) {\n                  _context2.next = 19;\n                  break;\n                }\n\n                _this2.doNothing();\n\n                _context2.next = 27;\n                break;\n\n              case 19:\n                _context2.next = 21;\n                return globalService.getData_Async(administratorAPI.API_GetCategoryGroup(_this2.m_CategoryGroupDto.parent.id));\n\n              case 21:\n                response = _context2.sent;\n\n                if (!response || !response.state) {\n                  _this2.toastError(_this2.$t(\"error.load\"));\n                } else {\n                  _this2.m_CategoryGroupDto.parent = response.data;\n                }\n\n                _context2.next = 25;\n                return globalService.getData_Async(administratorAPI.API_GetAllCategoryDataByCategoryGroupId(_this2.m_CategoryGroupDto.parent.id));\n\n              case 25:\n                response = _context2.sent;\n\n                if (!response || !response.state) {\n                  _this2.toastError(_this2.$t(\"error.load\"));\n                } else {\n                  _this2.options.context.items = response.data;\n                }\n\n              case 27:\n                _context2.next = 29;\n                return globalService.getData_Async(administratorAPI.API_GetAllCategoryDataByCategoryGroupId(_this2.categoryGroupId));\n\n              case 29:\n                response = _context2.sent;\n\n                if (response) {\n                  _context2.next = 32;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", _this2.toastError(_this2.$t(\"error.load\")));\n\n              case 32:\n                if (response.state) {\n                  _context2.next = 34;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", _this2.toastError(_this2.$t(\"error.load\")));\n\n              case 34:\n                _this2.items = response.data;\n                _context2.next = 40;\n                break;\n\n              case 37:\n                _context2.prev = 37;\n                _context2.t0 = _context2[\"catch\"](1);\n\n                _this2.toastError(_this2.$t(\"error.can_not_param\"));\n\n              case 40:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, null, [[1, 37]]);\n      }))();\n    },\n    saveCategoryData: function saveCategoryData() {\n      var _this3 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        var isEditing, response;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (_this3.categoryDataDto.value) {\n                  _context3.next = 2;\n                  break;\n                }\n\n                return _context3.abrupt(\"return\", _this3.toastError(_this3.$t(\"error.please_fill_form\")));\n\n              case 2:\n                if (!_this3.categoryDataDto.key) {\n                  _this3.categoryDataDto.key = _this3.getKeyFromValue(_this3.categoryDataDto.value);\n                }\n\n                if (_this3.m_CategoryGroupDto.id) {\n                  _context3.next = 5;\n                  break;\n                }\n\n                return _context3.abrupt(\"return\", _this3.toastError(_this3.$t(\"error.please_create_parent_first\")));\n\n              case 5:\n                isEditing = !!_this3.categoryDataDto.id;\n\n                if (!_this3.categoryDataDto.id) {\n                  _this3.categoryDataDto.created = _this3.getUserInfo();\n                  _this3.categoryDataDto.createdDate = new Date();\n                }\n\n                _this3.categoryDataDto.modified = _this3.getUserInfo();\n                _this3.categoryDataDto.modifiedate = new Date();\n                _this3.categoryDataDto.categoryGroup = _this3.m_CategoryGroupDto;\n                _this3.categoryDataDto.isDelete = false;\n                _context3.prev = 11;\n\n                if (isEditing) {\n                  _context3.next = 18;\n                  break;\n                }\n\n                _context3.next = 15;\n                return globalService.postData_Async(administratorAPI.API_CreateCategoryData(), _this3.categoryDataDto);\n\n              case 15:\n                response = _context3.sent;\n                _context3.next = 21;\n                break;\n\n              case 18:\n                _context3.next = 20;\n                return globalService.putData_Async(administratorAPI.API_UpdateCategoryData(_this3.categoryDataDto.id), _this3.categoryDataDto);\n\n              case 20:\n                response = _context3.sent;\n\n              case 21:\n                if (response) {\n                  _context3.next = 23;\n                  break;\n                }\n\n                return _context3.abrupt(\"return\", _this3.errorUpdate());\n\n              case 23:\n                if (response.state) {\n                  _context3.next = 25;\n                  break;\n                }\n\n                return _context3.abrupt(\"return\", _this3.errorUpdate());\n\n              case 25:\n                if (!isEditing) {\n                  _this3.items.push(response.data);\n                }\n\n                _this3.categoryDataDto.key = \"\";\n\n                _this3.toast(response.message);\n\n                _this3.$emit(constant.keys.save, true);\n\n                _context3.next = 34;\n                break;\n\n              case 31:\n                _context3.prev = 31;\n                _context3.t0 = _context3[\"catch\"](11);\n\n                _this3.toastError(_context3.t0);\n\n              case 34:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, null, [[11, 31]]);\n      }))();\n    },\n    saveCategoryGroup: function saveCategoryGroup() {\n      var _this4 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n        var response, isEditing;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                if (_this4.validRequiredText(_this4.m_CategoryGroupDto.name)) {\n                  _context4.next = 3;\n                  break;\n                }\n\n                _this4.toastError(_this4.$t(\"error.please_fill_form\"));\n\n                return _context4.abrupt(\"return\");\n\n              case 3:\n                console.log(_this4.m_CategoryGroupDto);\n                _this4.m_CategoryGroupDto.name = \"\".concat(_this4.m_CategoryGroupDto.name).trim();\n                _this4.m_CategoryGroupDto.description = _this4.m_CategoryGroupDto.description ? \"\".concat(_this4.m_CategoryGroupDto.description).trim() : \"\";\n\n                if (!(!_this4.m_CategoryGroupDto.name || _this4.m_CategoryGroupDto.name.trim() == \"\")) {\n                  _context4.next = 10;\n                  break;\n                }\n\n                _this4.$refs[\"categoryName\"].focus();\n\n                _this4.errName = _this4.$t(\"message.msg_1\");\n                return _context4.abrupt(\"return\");\n\n              case 10:\n                isEditing = !!_this4.m_CategoryGroupDto.id;\n\n                if (!_this4.m_CategoryGroupDto.id) {\n                  _this4.m_CategoryGroupDto.created = _this4.getUserInfo();\n                  _this4.m_CategoryGroupDto.createdDate = new Date();\n                }\n\n                _this4.m_CategoryGroupDto.modified = _this4.getUserInfo();\n                _this4.m_CategoryGroupDto.modifiedate = new Date();\n                _context4.prev = 14;\n\n                if (isEditing) {\n                  _context4.next = 21;\n                  break;\n                }\n\n                _context4.next = 18;\n                return globalService.postData_Async(administratorAPI.API_CreateCategoryGroup(), _this4.m_CategoryGroupDto);\n\n              case 18:\n                response = _context4.sent;\n                _context4.next = 24;\n                break;\n\n              case 21:\n                _context4.next = 23;\n                return globalService.putData_Async(administratorAPI.API_UpdateCategoryGroup(_this4.m_CategoryGroupDto.id), _this4.m_CategoryGroupDto);\n\n              case 23:\n                response = _context4.sent;\n\n              case 24:\n                if (response) {\n                  _context4.next = 26;\n                  break;\n                }\n\n                return _context4.abrupt(\"return\", _this4.errorUpdate());\n\n              case 26:\n                if (response.state) {\n                  _context4.next = 28;\n                  break;\n                }\n\n                return _context4.abrupt(\"return\", _this4.toastError(response.message));\n\n              case 28:\n                _this4.m_CategoryGroupDto = response.data;\n\n                _this4.toast(response.message);\n\n                if (!(!_this4.m_CategoryGroupDto.parent || !_this4.m_CategoryGroupDto.parent.id)) {\n                  _context4.next = 34;\n                  break;\n                }\n\n                _this4.doNothing();\n\n                _context4.next = 42;\n                break;\n\n              case 34:\n                _context4.next = 36;\n                return globalService.getData_Async(administratorAPI.API_GetCategoryGroup(_this4.m_CategoryGroupDto.parent.id));\n\n              case 36:\n                response = _context4.sent;\n\n                if (response) {\n                  _context4.next = 39;\n                  break;\n                }\n\n                return _context4.abrupt(\"return\", _this4.toastError(_this4.$t(\"error.load\")));\n\n              case 39:\n                if (response.state) {\n                  _context4.next = 41;\n                  break;\n                }\n\n                return _context4.abrupt(\"return\", _this4.toastError(_this4.$t(\"error.load\")));\n\n              case 41:\n                _this4.m_CategoryGroupDto.parent = response.data;\n\n              case 42:\n                _this4.$emit(constant.keys.save, true);\n\n                _context4.next = 48;\n                break;\n\n              case 45:\n                _context4.prev = 45;\n                _context4.t0 = _context4[\"catch\"](14);\n\n                _this4.toastError(_context4.t0);\n\n              case 48:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, null, [[14, 45]]);\n      }))();\n    },\n    editItem: function editItem(item) {\n      this.categoryDataDto = item;\n    },\n    deleteItem: function deleteItem(item) {\n      this.selected = [item].concat();\n      this.dialogDelete = true;\n    },\n    confirm: function confirm() {\n      var _this5 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5() {\n        var response, _iterator, _step, item, index;\n\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _this5.closeDelete();\n\n                _context5.prev = 1;\n                _context5.next = 4;\n                return globalService.postData_Async(administratorAPI.API_DeleteAllCategoryData(), _this5.selected);\n\n              case 4:\n                response = _context5.sent;\n\n                if (response) {\n                  _context5.next = 7;\n                  break;\n                }\n\n                return _context5.abrupt(\"return\", _this5.toastError(_this5.$t(\"error.delete\")));\n\n              case 7:\n                if (response.state) {\n                  _context5.next = 9;\n                  break;\n                }\n\n                return _context5.abrupt(\"return\", _this5.toastError(_this5.$t(\"error.delete\")));\n\n              case 9:\n                _this5.toast(_this5.$t(\"success.delete\"));\n\n                _iterator = _createForOfIteratorHelper(_this5.selected);\n\n                try {\n                  for (_iterator.s(); !(_step = _iterator.n()).done;) {\n                    item = _step.value;\n                    index = _this5.items.indexOf(item);\n\n                    _this5.items.splice(index, 1);\n                  }\n                } catch (err) {\n                  _iterator.e(err);\n                } finally {\n                  _iterator.f();\n                }\n\n                _context5.next = 17;\n                break;\n\n              case 14:\n                _context5.prev = 14;\n                _context5.t0 = _context5[\"catch\"](1);\n\n                _this5.toastError(_context5.t0);\n\n              case 17:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, null, [[1, 14]]);\n      }))();\n    },\n    closeDelete: function closeDelete() {\n      this.dialogDelete = false;\n    },\n    deleteAll: function deleteAll() {\n      this.dialogDelete = true;\n    },\n    onDataChange: function onDataChange() {\n      if (!this.categoryDataDto.key) {\n        this.categoryDataDto.key = this.getKeyFromValue(this.categoryDataDto.value);\n      }\n    },\n    removeParentCategoryGroup: function removeParentCategoryGroup() {\n      this.m_CategoryGroupDto.parent = null;\n      this.temp_Parent = null;\n    },\n    saveAllCategoryData: function saveAllCategoryData() {\n      var _this6 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6() {\n        var filterValue, response, tmp;\n        return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                filterValue = _this6.globalFilterValue;\n                _context6.prev = 1;\n                tmp = _this6.selected.map(function (element) {\n                  element.filterValue = filterValue;\n                  return element;\n                });\n                _context6.next = 5;\n                return globalService.postData_Async(administratorAPI.API_SaveAllCategoryData(), tmp);\n\n              case 5:\n                response = _context6.sent;\n\n                if (response) {\n                  _context6.next = 8;\n                  break;\n                }\n\n                return _context6.abrupt(\"return\", _this6.toastError(_this6.$t(\"error.update\")));\n\n              case 8:\n                if (response.state) {\n                  _context6.next = 10;\n                  break;\n                }\n\n                return _context6.abrupt(\"return\", _this6.toastError(response.message));\n\n              case 10:\n                return _context6.abrupt(\"return\", _this6.toast(response.message));\n\n              case 13:\n                _context6.prev = 13;\n                _context6.t0 = _context6[\"catch\"](1);\n                return _context6.abrupt(\"return\", _this6.toastError(_context6.t0));\n\n              case 16:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, null, [[1, 13]]);\n      }))();\n    },\n    m_update: function m_update(value) {\n      var _this7 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7() {\n        var response, responseCate, newData, temp;\n        return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                _this7.m_CategoryGroupDto = value;\n\n                if (!(!_this7.m_CategoryGroupDto || !_this7.m_CategoryGroupDto.id)) {\n                  _context7.next = 6;\n                  break;\n                }\n\n                _this7.categoryGroups = _this7.categoryGroupDtos.filter(function (entry) {\n                  if (entry.id != _this7.m_CategoryGroupDto.id) return entry;\n                });\n\n                if (!!value.parent && !!value.parent.id) {\n                  _this7.m_CategoryGroupDto.parent = _this7.categoryGroups.find(function (entry) {\n                    if (entry.id == value.parent.id && !entry.isDelete) return entry;\n                  });\n                }\n\n                _context7.next = 19;\n                break;\n\n              case 6:\n                _this7.categoryGroups = [];\n                _context7.next = 9;\n                return globalService.getData_Async(administratorAPI.API_GetAllChildByParentId(_this7.m_CategoryGroupDto.id));\n\n              case 9:\n                response = _context7.sent;\n                _context7.next = 12;\n                return globalService.getData_Async(administratorAPI.API_GetAllCategoryGroup());\n\n              case 12:\n                responseCate = _context7.sent;\n\n                if (!(!response || !response.state || !responseCate || !responseCate.state)) {\n                  _context7.next = 15;\n                  break;\n                }\n\n                return _context7.abrupt(\"return\");\n\n              case 15:\n                newData = responseCate.data.filter(function (entry) {\n                  return !entry.isDelete;\n                });\n                temp = response.data;\n                _this7.categoryGroups = newData.filter(function (e1) {\n                  return !temp.some(function (e2) {\n                    return e1.id == e2.id;\n                  });\n                });\n\n                if (!!value.parent && !!value.parent.id) {\n                  _this7.m_CategoryGroupDto.parent = _this7.categoryGroups.find(function (entry) {\n                    if (entry.id == value.parent.id && !entry.isDelete) return entry;\n                  });\n                }\n\n              case 19:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7);\n      }))();\n    },\n    cancel: function cancel() {\n      this.errName = \"\";\n      this.$emit(constant.keys.cancel, true);\n    },\n    onchangeName: function onchangeName() {\n      this.errName = \"\";\n    }\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgFA;AACA;AACA;AACA;AACA;AACA;EACAA,uBADA;EAEAC,wDAFA;EAGAC;IACAC,IADA,gBACAC,KADA,EACA;MACA,2CADA,CAEA;;MACAC;IACA,CALA;IAMAC,gBANA,4BAMAF,KANA,EAMA;MACA;MACA;IACA,CATA;IAUAG,iBAVA,6BAUAH,KAVA,EAUA;MACA;IACA;EAZA,CAHA;EAiBAI,cAjBA;EAkBAC,IAlBA,kBAkBA;IACA;MACAC,aADA;MAEAC,cAFA;MAGAC,sBAHA;MAIAC,yBAJA;MAKAC,uBALA;MAMAC,aANA;MAOAC,mBAPA;MAQAC,UARA;MASAC,oCATA;MAUAC,gCAVA;MAWAC,YAXA;MAYAC,eAZA;MAaAC,SAbA;MAcAC,eAdA;MAeAC,kBAfA;MAgBAC,yBAhBA;MAiBAC,uBAjBA;MAkBAC,WAlBA;MAmBAC;IAnBA;EAqBA,CAxCA;EAyCAC,OAzCA,qBAyCA,EAzCA;EA0CAC,OA1CA,qBA0CA;IAAA;;IAAA;MAAA;QAAA;UAAA;YAAA;cACA;;cADA;cAAA,OAEA,kBAFA;;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA;EAGA,CA7CA;EA8CAC;IACAC,UADA,wBACA;MAAA;;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACA;;gBADA;;gBAAA,IAIA,kCAJA;kBAAA;kBAAA;gBAAA;;gBAAA,kCAKA,mBALA;;cAAA;gBAOA;;gBAPA,IAQA,sBARA;kBAAA;kBAAA;gBAAA;;gBAAA;;cAAA;gBAAA;gBAAA,OAWAC,4BACAC,6DADA,CAXA;;cAAA;gBAWAC,QAXA;;gBAAA,IAcAA,QAdA;kBAAA;kBAAA;gBAAA;;gBAAA,kCAeA,0CAfA;;cAAA;gBAAA,IAiBAA,cAjBA;kBAAA;kBAAA;gBAAA;;gBAAA,kCAkBA,0CAlBA;;cAAA;gBAoBA;;gBApBA,MAsBA,8BACA,iCADA,IAEA,oCAxBA;kBAAA;kBAAA;gBAAA;;gBA0BA;;gBA1BA;gBAAA;;cAAA;gBAAA;gBAAA,OA4BAF,4BACAC,sCACA,mCADA,CADA,CA5BA;;cAAA;gBA4BAC,QA5BA;;gBAiCA;kBACA;gBACA,CAFA,MAEA;kBACA;gBACA;;gBArCA;gBAAA,OAsCAF,4BACAC,yDACA,mCADA,CADA,CAtCA;;cAAA;gBAsCAC,QAtCA;;gBA2CA;kBACA;gBACA,CAFA,MAEA;kBACA;gBACA;;cA/CA;gBAAA;gBAAA,OAiDAF,4BACAC,yDACA,sBADA,CADA,CAjDA;;cAAA;gBAiDAC,QAjDA;;gBAAA,IAsDAA,QAtDA;kBAAA;kBAAA;gBAAA;;gBAAA,kCAuDA,0CAvDA;;cAAA;gBAAA,IAyDAA,cAzDA;kBAAA;kBAAA;gBAAA;;gBAAA,kCA0DA,0CA1DA;;cAAA;gBA4DA;gBA5DA;gBAAA;;cAAA;gBAAA;gBAAA;;gBA8DA;;cA9DA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAgEA,CAjEA;IAmEAC,gBAnEA,8BAmEA;MAAA;;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,IACA,4BADA;kBAAA;kBAAA;gBAAA;;gBAAA,kCAEA,sDAFA;;cAAA;gBAIA;kBACA,oDACA,4BADA;gBAGA;;gBARA,IASA,4BATA;kBAAA;kBAAA;gBAAA;;gBAAA,kCAUA,kBACA,6CADA,CAVA;;cAAA;gBAcAC,SAdA,GAcA,2BAdA;;gBAgBA;kBACA;kBACA;gBACA;;gBACA;gBACA;gBACA;gBACA;gBAvBA;;gBAAA,IAyBAA,SAzBA;kBAAA;kBAAA;gBAAA;;gBAAA;gBAAA,OA0BAJ,6BACAC,yCADA,EAEA,sBAFA,CA1BA;;cAAA;gBA0BAC,QA1BA;gBAAA;gBAAA;;cAAA;gBAAA;gBAAA,OA+BAF,4BACAC,wCACA,yBADA,CADA,EAIA,sBAJA,CA/BA;;cAAA;gBA+BAC,QA/BA;;cAAA;gBAAA,IAsCAA,QAtCA;kBAAA;kBAAA;gBAAA;;gBAAA,kCAuCA,oBAvCA;;cAAA;gBAAA,IAyCAA,cAzCA;kBAAA;kBAAA;gBAAA;;gBAAA,kCA0CA,oBA1CA;;cAAA;gBA4CA;kBACA;gBACA;;gBACA;;gBACA;;gBACA;;gBAjDA;gBAAA;;cAAA;gBAAA;gBAAA;;gBAmDA;;cAnDA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAqDA,CAxHA;IAyHAG,iBAzHA,+BAyHA;MAAA;;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,IACA,wDADA;kBAAA;kBAAA;gBAAA;;gBAEA;;gBAFA;;cAAA;gBAKAjC;gBACA,iCACA,gDADA;gBAGA,kEACAkC,WADA,GAEA,uDAFA,GAGA,EAHA;;gBATA,MAcA,mCACA,2CAfA;kBAAA;kBAAA;gBAAA;;gBAiBA;;gBACA;gBAlBA;;cAAA;gBAsBAF,SAtBA,GAsBA,8BAtBA;;gBAuBA;kBACA;kBACA;gBACA;;gBACA;gBACA;gBA5BA;;gBAAA,IA8BAA,SA9BA;kBAAA;kBAAA;gBAAA;;gBAAA;gBAAA,OA+BAJ,6BACAC,0CADA,EAEA,yBAFA,CA/BA;;cAAA;gBA+BAC,QA/BA;gBAAA;gBAAA;;cAAA;gBAAA;gBAAA,OAoCAF,4BACAC,yCACA,4BADA,CADA,EAIA,yBAJA,CApCA;;cAAA;gBAoCAC,QApCA;;cAAA;gBAAA,IA2CAA,QA3CA;kBAAA;kBAAA;gBAAA;;gBAAA,kCA4CA,oBA5CA;;cAAA;gBAAA,IA8CAA,cA9CA;kBAAA;kBAAA;gBAAA;;gBAAA,kCA+CA,mCA/CA;;cAAA;gBAiDA;;gBACA;;gBAlDA,MAoDA,qCACA,oCArDA;kBAAA;kBAAA;gBAAA;;gBAuDA;;gBAvDA;gBAAA;;cAAA;gBAAA;gBAAA,OAyDAF,4BACAC,sCACA,mCADA,CADA,CAzDA;;cAAA;gBAyDAC,QAzDA;;gBAAA,IA8DAA,QA9DA;kBAAA;kBAAA;gBAAA;;gBAAA,kCA+DA,0CA/DA;;cAAA;gBAAA,IAiEAA,cAjEA;kBAAA;kBAAA;gBAAA;;gBAAA,kCAkEA,0CAlEA;;cAAA;gBAoEA;;cApEA;gBAsEA;;gBAtEA;gBAAA;;cAAA;gBAAA;gBAAA;;gBAwEA;;cAxEA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IA0EA,CAnMA;IAoMAK,QApMA,oBAoMAC,IApMA,EAoMA;MACA;IACA,CAtMA;IAuMAC,UAvMA,sBAuMAD,IAvMA,EAuMA;MACA;MACA;IACA,CA1MA;IA2MAE,OA3MA,qBA2MA;MAAA;;MAAA;QAAA;;QAAA;UAAA;YAAA;cAAA;gBAEA;;gBAFA;gBAAA;gBAAA,OAIAV,6BACAC,4CADA,EAEA,eAFA,CAJA;;cAAA;gBAIAC,QAJA;;gBAAA,IAQAA,QARA;kBAAA;kBAAA;gBAAA;;gBAAA,kCASA,4CATA;;cAAA;gBAAA,IAWAA,cAXA;kBAAA;kBAAA;gBAAA;;gBAAA,kCAYA,4CAZA;;cAAA;gBAcA;;gBAdA,uCAeA,eAfA;;gBAAA;kBAeA;oBAAAM;oBACAG,KADA,GACA,0BADA;;oBAEA;kBACA;gBAlBA;kBAAA;gBAAA;kBAAA;gBAAA;;gBAAA;gBAAA;;cAAA;gBAAA;gBAAA;;gBAoBA;;cApBA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAsBA,CAjOA;IAkOAC,WAlOA,yBAkOA;MACA;IACA,CApOA;IAqOAC,SArOA,uBAqOA;MACA;IACA,CAvOA;IAwOAC,YAxOA,0BAwOA;MACA;QACA,gDACA,0BADA;MAGA;IACA,CA9OA;IA+OAC,yBA/OA,uCA+OA;MACA;MACA;IACA,CAlPA;IAmPAC,mBAnPA,iCAmPA;MAAA;;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACAC,WADA,GACA,wBADA;gBAAA;gBAKAC;kBACAC;kBACA;gBACA,CAHA;gBALA;gBAAA,OASAnB,6BACAC,0CADA,EAEAiB,GAFA,CATA;;cAAA;gBASAhB,QATA;;gBAAA,IAaAA,QAbA;kBAAA;kBAAA;gBAAA;;gBAAA,kCAcA,4CAdA;;cAAA;gBAAA,IAgBAA,cAhBA;kBAAA;kBAAA;gBAAA;;gBAAA,kCAiBA,mCAjBA;;cAAA;gBAAA,kCAmBA,8BAnBA;;cAAA;gBAAA;gBAAA;gBAAA,kCAqBA,+BArBA;;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAuBA,CA1QA;IA2QAkB,QA3QA,oBA2QAjD,KA3QA,EA2QA;MAAA;;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACA;;gBADA,MAEA,2DAFA;kBAAA;kBAAA;gBAAA;;gBAGA;kBACA;gBACA,CAFA;;gBAGA;kBACA,8DACA;oBACA,oDACA;kBACA,CAJA;gBAMA;;gBAbA;gBAAA;;cAAA;gBAeA;gBAfA;gBAAA,OAgBA6B,4BACAC,2CACA,4BADA,CADA,CAhBA;;cAAA;gBAgBAC,QAhBA;gBAAA;gBAAA,OAqBAF,4BACAC,0CADA,CArBA;;cAAA;gBAqBAoB,YArBA;;gBAAA,MAyBA,aACA,eADA,IAEA,aAFA,IAGA,mBA5BA;kBAAA;kBAAA;gBAAA;;gBAAA;;cAAA;gBA+BAC,OA/BA,GA+BAD;kBACA;gBACA,CAFA,CA/BA;gBAkCAE,IAlCA,GAkCArB,aAlCA;gBAoCA;kBACA;oBAAA;kBAAA;gBACA,CAFA;;gBAIA;kBACA,8DACA;oBACA,oDACA;kBACA,CAJA;gBAMA;;cA/CA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAiDA,CA5TA;IA6TAsB,MA7TA,oBA6TA;MACA;MACA;IACA,CAhUA;IAiUAC,YAjUA,0BAiUA;MACA;IACA;EAnUA;AA9CA","names":["name","props","watch","edit","value","console","categoryGroupDto","categoryGroupDtos","components","data","errorName","is_edit","categoryGroupId","validCategoryGroup","validCategoryData","loading","dialogDelete","search","m_CategoryGroupDto","categoryDataDto","selected","editedIndex","items","parentItems","categoryGroups","categoryGroupParent","globalFilterValue","errName","descriptionError","created","mounted","methods","initialize","globalService","administratorAPI","response","saveCategoryData","isEditing","saveCategoryGroup","description","editItem","item","deleteItem","confirm","index","closeDelete","deleteAll","onDataChange","removeParentCategoryGroup","saveAllCategoryData","filterValue","tmp","element","m_update","responseCate","newData","temp","cancel","onchangeName"],"sourceRoot":"src/views/modules/administrator/Category","sources":["EditCategory.vue"],"sourcesContent":["<template>\n\t<v-card elevation=\"0\">\n\t\t<v-toolbar elevation=\"0\" color=\"grey lighten-4\">\n\t\t\t<v-toolbar-title>\n\t\t\t\t{{\n\t\t\t\t\t!m_CategoryGroupDto.id\n\t\t\t\t\t\t? $t(\"title.create_category_group\")\n\t\t\t\t\t\t: $t(\"title.edit_category_group\")\n\t\t\t\t}}\n\t\t\t</v-toolbar-title>\n\t\t\t<v-spacer></v-spacer>\n\t\t\t<v-btn icon @click=\"cancel\">\n\t\t\t\t<v-icon>mdi-close</v-icon>\n\t\t\t</v-btn>\n\t\t</v-toolbar>\n\t\t<v-card-text>\n\t\t\t<v-container>\n\t\t\t\t<v-row class=\"mt-2\">\n\t\t\t\t\t<v-col cols=\"12\">\n\t\t\t\t\t\t<v-form ref=\"form\">\n\t\t\t\t\t\t\t<v-text-field\n\t\t\t\t\t\t\t\t:label=\"$t('label.name')\"\n\t\t\t\t\t\t\t\t:error-messages=\"errName\"\n\t\t\t\t\t\t\t\t@keyup=\"onchangeName\"\n\t\t\t\t\t\t\t\tv-model=\"m_CategoryGroupDto.name\"\n\t\t\t\t\t\t\t\tmaxlength=\"255\"\n\t\t\t\t\t\t\t\toutlined\n\t\t\t\t\t\t\t\t:required=\"true\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</v-text-field>\n\n\t\t\t\t\t\t\t<v-textarea\n\t\t\t\t\t\t\t\t:label=\"$t('label.description')\"\n\t\t\t\t\t\t\t\tv-model=\"m_CategoryGroupDto.description\"\n\t\t\t\t\t\t\t\tmaxlength=\"500\"\n\t\t\t\t\t\t\t\toutlined\n\t\t\t\t\t\t\t></v-textarea>\n\n\t\t\t\t\t\t\t<v-autocomplete\n\t\t\t\t\t\t\t\tv-model=\"m_CategoryGroupDto.parent\"\n\t\t\t\t\t\t\t\t:items=\"categoryGroups\"\n\t\t\t\t\t\t\t\tclearable\n\t\t\t\t\t\t\t\t:label=\"$t('label.parent_node')\"\n\t\t\t\t\t\t\t\toutlined\n\t\t\t\t\t\t\t\thide-selected\n\t\t\t\t\t\t\t\tdense\n\t\t\t\t\t\t\t\titem-text=\"name\"\n\t\t\t\t\t\t\t\t:item-value=\"(item) => item\"\n\t\t\t\t\t\t\t\t:no-data-text=\"$t('message.no_results')\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</v-autocomplete>\n\t\t\t\t\t\t</v-form>\n\t\t\t\t\t</v-col>\n\t\t\t\t</v-row>\n\t\t\t</v-container>\n\t\t</v-card-text>\n\t\t<v-card-actions>\n\t\t\t<v-spacer></v-spacer>\n\t\t\t<v-btn\n\t\t\t\televation=\"0\"\n\t\t\t\tcolor=\"blue darken-2\"\n\t\t\t\tdark\n\t\t\t\tclass=\"rounded-0\"\n\t\t\t\t@click.stop=\"saveCategoryGroup()\"\n\t\t\t>\n\t\t\t\t{{ $t(\"button.ok\") }}\n\t\t\t</v-btn>\n\t\t\t<v-btn\n\t\t\t\televation=\"0\"\n\t\t\t\tcolor=\"grey lighten-4\"\n\t\t\t\tclass=\"rounded-0\"\n\t\t\t\t@click.stop=\"cancel()\"\n\t\t\t>\n\t\t\t\t{{ $t(\"button.cancel\") }}\n\t\t\t</v-btn>\n\t\t</v-card-actions>\n\t</v-card>\n</template>\n\n<script>\nimport globalService from \"@/services/global.service\";\nimport administratorAPI from \"../administrator.api\";\nimport CategoryDataDto from \"@/models/category-data.dto\";\nimport constant from \"@/common/constant\";\nimport CategoryGroupDTO from \"@/models/category-group.dto\";\nexport default {\n\tname: \"EditCategoryVue\",\n\tprops: [\"categoryGroupDto\", \"categoryGroupDtos\", \"edit\"],\n\twatch: {\n\t\tedit(value) {\n\t\t\tthis.m_CategoryGroupDto = CategoryGroupDTO;\n\t\t\t// this.$refs.form.reset();\n\t\t\tconsole.log(value);\n\t\t},\n\t\tcategoryGroupDto(value) {\n\t\t\tthis.$refs.form.reset();\n\t\t\tthis.m_update(value);\n\t\t},\n\t\tcategoryGroupDtos(value) {\n\t\t\tthis.categoryGroups = value;\n\t\t},\n\t},\n\tcomponents: {},\n\tdata() {\n\t\treturn {\n\t\t\terrorName: \"\",\n\t\t\tis_edit: false,\n\t\t\tcategoryGroupId: false,\n\t\t\tvalidCategoryGroup: false,\n\t\t\tvalidCategoryData: true,\n\t\t\tloading: true,\n\t\t\tdialogDelete: false,\n\t\t\tsearch: \"\",\n\t\t\tm_CategoryGroupDto: CategoryGroupDTO,\n\t\t\tcategoryDataDto: CategoryDataDto,\n\t\t\tselected: [],\n\t\t\teditedIndex: -1,\n\t\t\titems: [],\n\t\t\tparentItems: [],\n\t\t\tcategoryGroups: [],\n\t\t\tcategoryGroupParent: null,\n\t\t\tglobalFilterValue: null,\n\t\t\terrName: \"\",\n\t\t\tdescriptionError: \"\",\n\t\t};\n\t},\n\tcreated() {},\n\tasync mounted() {\n\t\tthis.$refs.form.reset();\n\t\tawait this.initialize();\n\t},\n\tmethods: {\n\t\tasync initialize() {\n\t\t\tthis.m_update(this.categoryGroupDto);\n\t\t\tlet response;\n\t\t\ttry {\n\t\t\t\tif (!this.$router.currentRoute.params) {\n\t\t\t\t\treturn this.finishLoad();\n\t\t\t\t}\n\t\t\t\tthis.categoryGroupId = this.$router.currentRoute.params.id;\n\t\t\t\tif (!this.categoryGroupId) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tresponse = await globalService.getData_Async(\n\t\t\t\t\tadministratorAPI.API_GetCategoryGroup(this.categoryGroupId),\n\t\t\t\t);\n\t\t\t\tif (!response) {\n\t\t\t\t\treturn this.toastError(this.$t(\"error.load\"));\n\t\t\t\t}\n\t\t\t\tif (!response.state) {\n\t\t\t\t\treturn this.toastError(this.$t(\"error.load\"));\n\t\t\t\t}\n\t\t\t\tthis.m_CategoryGroupDto = response.data;\n\t\t\t\tif (\n\t\t\t\t\t!this.m_CategoryGroupDto ||\n\t\t\t\t\t!this.m_CategoryGroupDto.parent ||\n\t\t\t\t\t!this.m_CategoryGroupDto.parent.id\n\t\t\t\t) {\n\t\t\t\t\tthis.doNothing();\n\t\t\t\t} else {\n\t\t\t\t\tresponse = await globalService.getData_Async(\n\t\t\t\t\t\tadministratorAPI.API_GetCategoryGroup(\n\t\t\t\t\t\t\tthis.m_CategoryGroupDto.parent.id,\n\t\t\t\t\t\t),\n\t\t\t\t\t);\n\t\t\t\t\tif (!response || !response.state) {\n\t\t\t\t\t\tthis.toastError(this.$t(\"error.load\"));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.m_CategoryGroupDto.parent = response.data;\n\t\t\t\t\t}\n\t\t\t\t\tresponse = await globalService.getData_Async(\n\t\t\t\t\t\tadministratorAPI.API_GetAllCategoryDataByCategoryGroupId(\n\t\t\t\t\t\t\tthis.m_CategoryGroupDto.parent.id,\n\t\t\t\t\t\t),\n\t\t\t\t\t);\n\t\t\t\t\tif (!response || !response.state) {\n\t\t\t\t\t\tthis.toastError(this.$t(\"error.load\"));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.options.context.items = response.data;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tresponse = await globalService.getData_Async(\n\t\t\t\t\tadministratorAPI.API_GetAllCategoryDataByCategoryGroupId(\n\t\t\t\t\t\tthis.categoryGroupId,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t\tif (!response) {\n\t\t\t\t\treturn this.toastError(this.$t(\"error.load\"));\n\t\t\t\t}\n\t\t\t\tif (!response.state) {\n\t\t\t\t\treturn this.toastError(this.$t(\"error.load\"));\n\t\t\t\t}\n\t\t\t\tthis.items = response.data;\n\t\t\t} catch (error) {\n\t\t\t\tthis.toastError(this.$t(\"error.can_not_param\"));\n\t\t\t}\n\t\t},\n\n\t\tasync saveCategoryData() {\n\t\t\tif (!this.categoryDataDto.value) {\n\t\t\t\treturn this.toastError(this.$t(\"error.please_fill_form\"));\n\t\t\t}\n\t\t\tif (!this.categoryDataDto.key) {\n\t\t\t\tthis.categoryDataDto.key = this.getKeyFromValue(\n\t\t\t\t\tthis.categoryDataDto.value,\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (!this.m_CategoryGroupDto.id) {\n\t\t\t\treturn this.toastError(\n\t\t\t\t\tthis.$t(\"error.please_create_parent_first\"),\n\t\t\t\t);\n\t\t\t}\n\t\t\tlet isEditing = !!this.categoryDataDto.id;\n\t\t\tlet response;\n\t\t\tif (!this.categoryDataDto.id) {\n\t\t\t\tthis.categoryDataDto.created = this.getUserInfo();\n\t\t\t\tthis.categoryDataDto.createdDate = new Date();\n\t\t\t}\n\t\t\tthis.categoryDataDto.modified = this.getUserInfo();\n\t\t\tthis.categoryDataDto.modifiedate = new Date();\n\t\t\tthis.categoryDataDto.categoryGroup = this.m_CategoryGroupDto;\n\t\t\tthis.categoryDataDto.isDelete = false;\n\t\t\ttry {\n\t\t\t\tif (!isEditing) {\n\t\t\t\t\tresponse = await globalService.postData_Async(\n\t\t\t\t\t\tadministratorAPI.API_CreateCategoryData(),\n\t\t\t\t\t\tthis.categoryDataDto,\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tresponse = await globalService.putData_Async(\n\t\t\t\t\t\tadministratorAPI.API_UpdateCategoryData(\n\t\t\t\t\t\t\tthis.categoryDataDto.id,\n\t\t\t\t\t\t),\n\t\t\t\t\t\tthis.categoryDataDto,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif (!response) {\n\t\t\t\t\treturn this.errorUpdate();\n\t\t\t\t}\n\t\t\t\tif (!response.state) {\n\t\t\t\t\treturn this.errorUpdate();\n\t\t\t\t}\n\t\t\t\tif (!isEditing) {\n\t\t\t\t\tthis.items.push(response.data);\n\t\t\t\t}\n\t\t\t\tthis.categoryDataDto.key = \"\";\n\t\t\t\tthis.toast(response.message);\n\t\t\t\tthis.$emit(constant.keys.save, true);\n\t\t\t} catch (error) {\n\t\t\t\tthis.toastError(error);\n\t\t\t}\n\t\t},\n\t\tasync saveCategoryGroup() {\n\t\t\tif (!this.validRequiredText(this.m_CategoryGroupDto.name)) {\n\t\t\t\tthis.toastError(this.$t(\"error.please_fill_form\"));\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconsole.log(this.m_CategoryGroupDto);\n\t\t\tthis.m_CategoryGroupDto.name =\n\t\t\t\t`${this.m_CategoryGroupDto.name}`.trim();\n\n\t\t\tthis.m_CategoryGroupDto.description = this.m_CategoryGroupDto\n\t\t\t\t.description\n\t\t\t\t? `${this.m_CategoryGroupDto.description}`.trim()\n\t\t\t\t: \"\";\n\t\t\tif (\n\t\t\t\t!this.m_CategoryGroupDto.name ||\n\t\t\t\tthis.m_CategoryGroupDto.name.trim() == \"\"\n\t\t\t) {\n\t\t\t\tthis.$refs[\"categoryName\"].focus();\n\t\t\t\tthis.errName = this.$t(\"message.msg_1\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet response;\n\t\t\tlet isEditing = !!this.m_CategoryGroupDto.id;\n\t\t\tif (!this.m_CategoryGroupDto.id) {\n\t\t\t\tthis.m_CategoryGroupDto.created = this.getUserInfo();\n\t\t\t\tthis.m_CategoryGroupDto.createdDate = new Date();\n\t\t\t}\n\t\t\tthis.m_CategoryGroupDto.modified = this.getUserInfo();\n\t\t\tthis.m_CategoryGroupDto.modifiedate = new Date();\n\t\t\ttry {\n\t\t\t\tif (!isEditing) {\n\t\t\t\t\tresponse = await globalService.postData_Async(\n\t\t\t\t\t\tadministratorAPI.API_CreateCategoryGroup(),\n\t\t\t\t\t\tthis.m_CategoryGroupDto,\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tresponse = await globalService.putData_Async(\n\t\t\t\t\t\tadministratorAPI.API_UpdateCategoryGroup(\n\t\t\t\t\t\t\tthis.m_CategoryGroupDto.id,\n\t\t\t\t\t\t),\n\t\t\t\t\t\tthis.m_CategoryGroupDto,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif (!response) {\n\t\t\t\t\treturn this.errorUpdate();\n\t\t\t\t}\n\t\t\t\tif (!response.state) {\n\t\t\t\t\treturn this.toastError(response.message);\n\t\t\t\t}\n\t\t\t\tthis.m_CategoryGroupDto = response.data;\n\t\t\t\tthis.toast(response.message);\n\t\t\t\tif (\n\t\t\t\t\t!this.m_CategoryGroupDto.parent ||\n\t\t\t\t\t!this.m_CategoryGroupDto.parent.id\n\t\t\t\t) {\n\t\t\t\t\tthis.doNothing();\n\t\t\t\t} else {\n\t\t\t\t\tresponse = await globalService.getData_Async(\n\t\t\t\t\t\tadministratorAPI.API_GetCategoryGroup(\n\t\t\t\t\t\t\tthis.m_CategoryGroupDto.parent.id,\n\t\t\t\t\t\t),\n\t\t\t\t\t);\n\t\t\t\t\tif (!response) {\n\t\t\t\t\t\treturn this.toastError(this.$t(\"error.load\"));\n\t\t\t\t\t}\n\t\t\t\t\tif (!response.state) {\n\t\t\t\t\t\treturn this.toastError(this.$t(\"error.load\"));\n\t\t\t\t\t}\n\t\t\t\t\tthis.m_CategoryGroupDto.parent = response.data;\n\t\t\t\t}\n\t\t\t\tthis.$emit(constant.keys.save, true);\n\t\t\t} catch (error) {\n\t\t\t\tthis.toastError(error);\n\t\t\t}\n\t\t},\n\t\teditItem(item) {\n\t\t\tthis.categoryDataDto = item;\n\t\t},\n\t\tdeleteItem(item) {\n\t\t\tthis.selected = [...[item]];\n\t\t\tthis.dialogDelete = true;\n\t\t},\n\t\tasync confirm() {\n\t\t\tlet response;\n\t\t\tthis.closeDelete();\n\t\t\ttry {\n\t\t\t\tresponse = await globalService.postData_Async(\n\t\t\t\t\tadministratorAPI.API_DeleteAllCategoryData(),\n\t\t\t\t\tthis.selected,\n\t\t\t\t);\n\t\t\t\tif (!response) {\n\t\t\t\t\treturn this.toastError(this.$t(\"error.delete\"));\n\t\t\t\t}\n\t\t\t\tif (!response.state) {\n\t\t\t\t\treturn this.toastError(this.$t(\"error.delete\"));\n\t\t\t\t}\n\t\t\t\tthis.toast(this.$t(\"success.delete\"));\n\t\t\t\tfor (let item of this.selected) {\n\t\t\t\t\tlet index = this.items.indexOf(item);\n\t\t\t\t\tthis.items.splice(index, 1);\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tthis.toastError(error);\n\t\t\t}\n\t\t},\n\t\tcloseDelete() {\n\t\t\tthis.dialogDelete = false;\n\t\t},\n\t\tdeleteAll() {\n\t\t\tthis.dialogDelete = true;\n\t\t},\n\t\tonDataChange() {\n\t\t\tif (!this.categoryDataDto.key) {\n\t\t\t\tthis.categoryDataDto.key = this.getKeyFromValue(\n\t\t\t\t\tthis.categoryDataDto.value,\n\t\t\t\t);\n\t\t\t}\n\t\t},\n\t\tremoveParentCategoryGroup() {\n\t\t\tthis.m_CategoryGroupDto.parent = null;\n\t\t\tthis.temp_Parent = null;\n\t\t},\n\t\tasync saveAllCategoryData() {\n\t\t\tlet filterValue = this.globalFilterValue;\n\t\t\tlet response;\n\t\t\tlet tmp;\n\t\t\ttry {\n\t\t\t\ttmp = this.selected.map((element) => {\n\t\t\t\t\telement.filterValue = filterValue;\n\t\t\t\t\treturn element;\n\t\t\t\t});\n\t\t\t\tresponse = await globalService.postData_Async(\n\t\t\t\t\tadministratorAPI.API_SaveAllCategoryData(),\n\t\t\t\t\ttmp,\n\t\t\t\t);\n\t\t\t\tif (!response) {\n\t\t\t\t\treturn this.toastError(this.$t(\"error.update\"));\n\t\t\t\t}\n\t\t\t\tif (!response.state) {\n\t\t\t\t\treturn this.toastError(response.message);\n\t\t\t\t}\n\t\t\t\treturn this.toast(response.message);\n\t\t\t} catch (error) {\n\t\t\t\treturn this.toastError(error);\n\t\t\t}\n\t\t},\n\t\tasync m_update(value) {\n\t\t\tthis.m_CategoryGroupDto = value;\n\t\t\tif (!this.m_CategoryGroupDto || !this.m_CategoryGroupDto.id) {\n\t\t\t\tthis.categoryGroups = this.categoryGroupDtos.filter((entry) => {\n\t\t\t\t\tif (entry.id != this.m_CategoryGroupDto.id) return entry;\n\t\t\t\t});\n\t\t\t\tif (!!value.parent && !!value.parent.id) {\n\t\t\t\t\tthis.m_CategoryGroupDto.parent = this.categoryGroups.find(\n\t\t\t\t\t\t(entry) => {\n\t\t\t\t\t\t\tif (entry.id == value.parent.id && !entry.isDelete)\n\t\t\t\t\t\t\t\treturn entry;\n\t\t\t\t\t\t},\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.categoryGroups = [];\n\t\t\t\tlet response = await globalService.getData_Async(\n\t\t\t\t\tadministratorAPI.API_GetAllChildByParentId(\n\t\t\t\t\t\tthis.m_CategoryGroupDto.id,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t\tlet responseCate = await globalService.getData_Async(\n\t\t\t\t\tadministratorAPI.API_GetAllCategoryGroup(),\n\t\t\t\t);\n\t\t\t\tif (\n\t\t\t\t\t!response ||\n\t\t\t\t\t!response.state ||\n\t\t\t\t\t!responseCate ||\n\t\t\t\t\t!responseCate.state\n\t\t\t\t)\n\t\t\t\t\treturn;\n\t\t\t\tlet newData = responseCate.data.filter((entry) => {\n\t\t\t\t\treturn !entry.isDelete;\n\t\t\t\t});\n\t\t\t\tlet temp = response.data;\n\n\t\t\t\tthis.categoryGroups = newData.filter((e1) => {\n\t\t\t\t\treturn !temp.some((e2) => e1.id == e2.id);\n\t\t\t\t});\n\n\t\t\t\tif (!!value.parent && !!value.parent.id) {\n\t\t\t\t\tthis.m_CategoryGroupDto.parent = this.categoryGroups.find(\n\t\t\t\t\t\t(entry) => {\n\t\t\t\t\t\t\tif (entry.id == value.parent.id && !entry.isDelete)\n\t\t\t\t\t\t\t\treturn entry;\n\t\t\t\t\t\t},\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tcancel() {\n\t\t\tthis.errName = \"\";\n\t\t\tthis.$emit(constant.keys.cancel, true);\n\t\t},\n\t\tonchangeName() {\n\t\t\tthis.errName = \"\";\n\t\t},\n\t},\n};\n</script>\n\n<style></style>\n"]},"metadata":{},"sourceType":"module"}