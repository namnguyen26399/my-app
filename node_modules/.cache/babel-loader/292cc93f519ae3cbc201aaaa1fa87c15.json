{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/nam/OneDrive/M\\xE1y t\\xEDnh/New folder/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/nam/OneDrive/M\\xE1y t\\xEDnh/New folder/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.array.splice.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport store from \"@/store\";\nimport TemplateFormDto from \"@/models/template-form.dto\";\nimport globalService from \"@/services/global.service\";\nimport administratorAPI from \"../administrator.api\";\nimport FormOption from \"../FormOption/FormOption.vue\";\nimport RequestDto from \"@/models/request.dto\";\nexport default {\n  name: \"EditTempalteFormV2Vue\",\n  components: {\n    FormOption: FormOption\n  },\n  props: {\n    Form: {},\n    requestDto: {}\n  },\n  computed: {},\n  watch: {\n    \"templateForm.attachmentFileDTOS\": function () {\n      var _templateFormAttachmentFileDTOS = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(value) {\n        var response, id, i;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                id = value[0].id;\n                _context.next = 4;\n                return globalService.getData_Async(administratorAPI.API_GetPreviewLink(id));\n\n              case 4:\n                response = _context.sent;\n\n                if (!(!response || !response.state)) {\n                  _context.next = 7;\n                  break;\n                }\n\n                return _context.abrupt(\"return\");\n\n              case 7:\n                this.previewLink = response.data;\n                this.items = JSON.parse(this.templateForm.mappingInfo);\n                this.list_field_tempalteform = JSON.parse(this.templateForm.mappingInfo);\n\n                for (i = 0; i < this.list_field_tempalteform.length; i++) {\n                  this.list_field_tempalteform[i] = this.list_field_tempalteform[i].name;\n                }\n\n                _context.next = 16;\n                break;\n\n              case 13:\n                _context.prev = 13;\n                _context.t0 = _context[\"catch\"](0);\n                return _context.abrupt(\"return\");\n\n              case 16:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 13]]);\n      }));\n\n      function templateFormAttachmentFileDTOS(_x) {\n        return _templateFormAttachmentFileDTOS.apply(this, arguments);\n      }\n\n      return templateFormAttachmentFileDTOS;\n    }(),\n    Form: function Form(value) {\n      this.form = value;\n    },\n    requestDto: function requestDto(value) {\n      this.m_requestDto = value;\n    }\n  },\n  data: function data() {\n    return {\n      m_requestDto: RequestDto,\n      form: [],\n      tabs: [{\n        key: \"information\",\n        title: this.$t(\"label.information\")\n      }],\n      buttons: [{\n        icon: \"mdi-content-save\",\n        title: this.$t(\"button.save\"),\n        color: \"blue darken-2\",\n        transparent: false,\n        dark: true,\n        event: this.save\n      }, {\n        icon: \"mdi-trash-can-outline\",\n        title: this.$t(\"button.delete\"),\n        color: \"black\",\n        transparent: true,\n        dark: false,\n        event: this.delete\n      }, {\n        icon: \"mdi-arrow-left-top\",\n        title: this.$t(\"button.back\"),\n        color: \"black\",\n        transparent: true,\n        dark: false,\n        event: this.back\n      }],\n      templateForm: Object.assign({}, TemplateFormDto),\n      m_template: Object.assign({}, TemplateFormDto),\n      headers: [{\n        text: this.$t(\"Trường dữ liệu form\"),\n        align: \"start\",\n        value: \"position\"\n      }, {\n        text: this.$t(\"Trường dữ liệu biểu mẫu\"),\n        align: \"start\",\n        value: \"name\"\n      }, {\n        text: this.$t(\"label.manipulation\"),\n        align: \"start\",\n        sortable: false,\n        value: \"action\"\n      }],\n      creating: false,\n      editing: false,\n      mapping: {\n        name: \"\",\n        position: \"\"\n      },\n      previewLink: \"\",\n      templates: [],\n      items: [],\n      dialog: {\n        formOption: false\n      },\n      list_field_form: [],\n      list_field_tempalteform: []\n    };\n  },\n  created: function created() {\n    var _this = this;\n\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              store.state.loading = false;\n              _this.form = _this.Form;\n              _this.m_requestDto = _this.requestDto;\n              _context2.next = 5;\n              return _this.initialize();\n\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }))();\n  },\n  mounted: function mounted() {// store.state.loading = false;\n  },\n  methods: {\n    initialize: function initialize() {\n      var _this2 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        var i, j;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return _this2.getFormForm();\n\n              case 2:\n                if (_this2.form.length > 0) {\n                  for (i = 0; i < _this2.form.length; i++) {\n                    for (j = 0; j < _this2.form[i].elements.length; j++) {\n                      _this2.list_field_form.push({\n                        id: \"{{\".concat(_this2.form[i].elements[j].field.configModel.id, \"}}\"),\n                        id_name: _this2.form[i].elements[j].field.configModel.title\n                      });\n                    }\n                  }\n                }\n\n              case 3:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }))();\n    },\n    getListTemplate: function getListTemplate() {\n      var _this3 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n        var response;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.next = 2;\n                return globalService.getData_Async(administratorAPI.API_GetAllTemplateForm());\n\n              case 2:\n                response = _context4.sent;\n\n                if (response.state) {\n                  _context4.next = 5;\n                  break;\n                }\n\n                return _context4.abrupt(\"return\");\n\n              case 5:\n                _this3.templates = response.data.filter(function (entry) {\n                  return !entry.isDelete;\n                });\n\n                _this3.sortList(_this3.templates);\n\n              case 7:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4);\n      }))();\n    },\n    handleButtonClick: function handleButtonClick(event) {\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5() {\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.next = 2;\n                return event();\n\n              case 2:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5);\n      }))();\n    },\n    handleFile: function handleFile(event) {\n      var _this4 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6() {\n        var canUpload, response;\n        return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                if (event) {\n                  _context6.next = 2;\n                  break;\n                }\n\n                return _context6.abrupt(\"return\");\n\n              case 2:\n                canUpload = true;\n\n                if (_this4.templateForm.id) {\n                  _context6.next = 7;\n                  break;\n                }\n\n                _context6.next = 6;\n                return _this4.save();\n\n              case 6:\n                canUpload = _context6.sent;\n\n              case 7:\n                if (canUpload) {\n                  _context6.next = 9;\n                  break;\n                }\n\n                return _context6.abrupt(\"return\");\n\n              case 9:\n                _context6.prev = 9;\n                _context6.next = 12;\n                return globalService.upload_Async(administratorAPI.API_UploadTemplateFileCloud(_this4.templateForm.id), event);\n\n              case 12:\n                response = _context6.sent;\n\n                if (response) {\n                  _context6.next = 16;\n                  break;\n                }\n\n                _this4.toastError(response);\n\n                return _context6.abrupt(\"return\");\n\n              case 16:\n                if (response.state) {\n                  _context6.next = 19;\n                  break;\n                }\n\n                _this4.toastError(response.messgage);\n\n                return _context6.abrupt(\"return\");\n\n              case 19:\n                if (!_this4.templateForm.attachmentFileDTOS) {\n                  _this4.templateForm.attachmentFileDTOS = [];\n                }\n\n                _this4.templateForm.attachmentFileDTOS.push(response.data);\n\n                _context6.next = 26;\n                break;\n\n              case 23:\n                _context6.prev = 23;\n                _context6.t0 = _context6[\"catch\"](9);\n\n                _this4.toastError(_context6.t0);\n\n              case 26:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, null, [[9, 23]]);\n      }))();\n    },\n    save: function save() {\n      var _this5 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7() {\n        var response;\n        return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                _this5.templateForm.mappingInfo = JSON.stringify(_this5.items);\n                _this5.templateForm.modified = _this5.getUserInfo();\n                _this5.templateForm.modifiedDate = new Date();\n                _this5.templateForm.modifiedName = _this5.getUserInfo().fullName;\n\n                if (!_this5.templateForm.id) {\n                  _this5.templateForm.created = _this5.getUserInfo();\n                  _this5.templateForm.createdDate = new Date();\n                  _this5.templateForm.createdName = _this5.getUserInfo().fullName;\n                }\n\n                _context7.prev = 5;\n\n                if (_this5.templateForm.id) {\n                  _context7.next = 12;\n                  break;\n                }\n\n                _context7.next = 9;\n                return globalService.postData_Async(administratorAPI.API_CreateTemplateForm(), _this5.templateForm);\n\n              case 9:\n                response = _context7.sent;\n                _context7.next = 15;\n                break;\n\n              case 12:\n                _context7.next = 14;\n                return globalService.putData_Async(administratorAPI.API_SaveTemplateForm(_this5.templateForm.id), _this5.templateForm);\n\n              case 14:\n                response = _context7.sent;\n\n              case 15:\n                if (response) {\n                  _context7.next = 18;\n                  break;\n                }\n\n                _this5.toastError(response);\n\n                return _context7.abrupt(\"return\", false);\n\n              case 18:\n                if (response.state) {\n                  _context7.next = 21;\n                  break;\n                }\n\n                _this5.toastError(response.messgage);\n\n                return _context7.abrupt(\"return\", false);\n\n              case 21:\n                _this5.templateForm = response.data;\n                return _context7.abrupt(\"return\", true);\n\n              case 25:\n                _context7.prev = 25;\n                _context7.t0 = _context7[\"catch\"](5);\n\n                _this5.toastError(_context7.t0);\n\n                return _context7.abrupt(\"return\", false);\n\n              case 29:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, null, [[5, 25]]);\n      }))();\n    },\n    delete: function _delete() {\n      var _this6 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8() {\n        var response;\n        return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                _context8.prev = 0;\n                _context8.next = 3;\n                return globalService.deleteData_Async(administratorAPI.API_DeleteTemplateForm(_this6.templateForm.id));\n\n              case 3:\n                response = _context8.sent;\n\n                if (response) {\n                  _context8.next = 7;\n                  break;\n                }\n\n                _this6.toastError(response);\n\n                return _context8.abrupt(\"return\");\n\n              case 7:\n                if (response.state) {\n                  _context8.next = 10;\n                  break;\n                }\n\n                _this6.toastError(response.messgage);\n\n                return _context8.abrupt(\"return\");\n\n              case 10:\n                _this6.$router.push({\n                  path: \".\"\n                });\n\n                _context8.next = 16;\n                break;\n\n              case 13:\n                _context8.prev = 13;\n                _context8.t0 = _context8[\"catch\"](0);\n\n                _this6.toastError(_context8.t0);\n\n              case 16:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, null, [[0, 13]]);\n      }))();\n    },\n    back: function back() {\n      this.$router.push({\n        path: \"./\"\n      });\n    },\n    appendItem: function appendItem() {\n      this.creating = true;\n      this.editing = null;\n      this.mapping = {\n        name: \"\",\n        position: \"\"\n      };\n    },\n    add: function add() {\n      var temp = [];\n\n      try {\n        temp = JSON.parse(this.templateForm.mappingInfo);\n      } catch (error) {\n        temp = [];\n      }\n\n      temp.push(this.mapping);\n      this.items.push(this.mapping);\n      this.templateForm.mappingInfo = JSON.stringify(temp);\n      this.mapping = {\n        name: \"\",\n        position: \"\"\n      };\n    },\n    edit: function edit(item) {\n      this.editing = item;\n      this.mapping = item;\n      this.creating = false;\n    },\n    update: function update() {\n      this.templateForm.mappingInfo = JSON.stringify(this.items);\n      this.creating = false;\n      this.editing = null;\n    },\n\n    /**\r\n     * @return {Array}\r\n     */\n    _items: function _items() {\n      try {\n        return JSON.parse(this.templateForm.mappingInfo);\n      } catch (error) {\n        return [];\n      }\n    },\n    deleteItem: function deleteItem(item) {\n      var index = this.items.indexOf(item);\n      this.items.splice(index, 1);\n      this.templateForm.mappingInfo = JSON.stringify(this.items);\n    },\n    openSelectFormOption: function openSelectFormOption() {\n      this.dialog.formOption = true;\n    },\n    onSaveFile: function onSaveFile(value) {\n      this.listFile = value;\n      this.templates = value;\n    },\n    onClose: function onClose(value) {\n      if (value) {\n        this.dialog.formOption = false;\n      }\n    },\n    getFormForm: function getFormForm() {\n      var _this7 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee9() {\n        var response_All_Fields;\n        return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                if (!(!_this7.m_requestDto.form || !_this7.m_requestDto.form.id)) {\n                  _context9.next = 2;\n                  break;\n                }\n\n                return _context9.abrupt(\"return\");\n\n              case 2:\n                _context9.next = 4;\n                return globalService.getData_Async(\"/api/forms/\".concat(_this7.m_requestDto.form.id));\n\n              case 4:\n                response_All_Fields = _context9.sent;\n                _this7.form = JSON.parse(response_All_Fields.data.objectSchema);\n\n              case 6:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9);\n      }))();\n    }\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4LA;AACA;AACA;AACA;AACA;AACA;AAEA;EACAA,6BADA;EAEAC;IAAAC;EAAA,CAFA;EAGAC;IACAC,QADA;IAEAC;EAFA,CAHA;EAOAC,YAPA;EAQAC;IACA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAGAC,EAHA,GAGAC,WAHA;gBAAA;gBAAA,OAIAC,4BACAC,uCADA,CAJA;;cAAA;gBAIAC,QAJA;;gBAAA,MAOA,4BAPA;kBAAA;kBAAA;gBAAA;;gBAAA;;cAAA;gBAUA;gBACA;gBACA,0CACA,6BADA;;gBAGA;kBACA,kCACA,oCADA;gBAEA;;gBAlBA;gBAAA;;cAAA;gBAAA;gBAAA;gBAAA;;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;;MAAA;QAAA;MAAA;;MAAA;IAAA,GADA;IAwBAR,IAxBA,gBAwBAK,KAxBA,EAwBA;MACA;IACA,CA1BA;IA2BAJ,UA3BA,sBA2BAI,KA3BA,EA2BA;MACA;IACA;EA7BA,CARA;EAuCAI,IAvCA,kBAuCA;IACA;MACAC,wBADA;MAEAC,QAFA;MAGAC;QAAAC;QAAAC;MAAA,EAHA;MAIAC,UACA;QACAC,wBADA;QAEAF,6BAFA;QAGAG,sBAHA;QAIAC,kBAJA;QAKAC,UALA;QAMAC;MANA,CADA,EASA;QACAJ,6BADA;QAEAF,+BAFA;QAGAG,cAHA;QAIAC,iBAJA;QAKAC,WALA;QAMAC;MANA,CATA,EAiBA;QACAJ,0BADA;QAEAF,6BAFA;QAGAG,cAHA;QAIAC,iBAJA;QAKAC,WALA;QAMAC;MANA,CAjBA,CAJA;MA8BAC,gDA9BA;MA+BAC,8CA/BA;MAgCAC,UACA;QACAC,oCADA;QAEAC,cAFA;QAGApB;MAHA,CADA,EAMA;QACAmB,wCADA;QAEAC,cAFA;QAGApB;MAHA,CANA,EAWA;QACAmB,mCADA;QAEAC,cAFA;QAGAC,eAHA;QAIArB;MAJA,CAXA,CAhCA;MAkDAsB,eAlDA;MAmDAC,cAnDA;MAoDAC;QACAjC,QADA;QAEAkC;MAFA,CApDA;MAwDAC,eAxDA;MAyDAC,aAzDA;MA0DAC,SA1DA;MA2DAC;QACAC;MADA,CA3DA;MA8DAC,mBA9DA;MA+DAC;IA/DA;EAiEA,CAzGA;EA0GAC,OA1GA,qBA0GA;IAAA;;IAAA;MAAA;QAAA;UAAA;YAAA;cACAC;cACA;cACA;cAHA;cAAA,OAIA,kBAJA;;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA;EAKA,CA/GA;EAgHAC,OAhHA,qBAgHA,CACA;EACA,CAlHA;EAmHAC;IACAC,UADA,wBACA;MAAA;;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA,OACA,oBADA;;cAAA;gBAEA;kBACA;oBACA;sBACA;wBACAtC,sEADA;wBAEAuC,SACA,6CACA7B;sBAJA;oBAMA;kBACA;gBACA;;cAbA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAcA,CAfA;IAgBA8B,eAhBA,6BAgBA;MAAA;;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA,OACAtC,4BACAC,yCADA,CADA;;cAAA;gBACAC,QADA;;gBAAA,IAIAA,cAJA;kBAAA;kBAAA;gBAAA;;gBAAA;;cAAA;gBAOA;kBACA;gBACA,CAFA;;gBAGA;;cAVA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAWA,CA3BA;IA6BAqC,iBA7BA,6BA6BAzB,KA7BA,EA6BA;MAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA,OACAA,OADA;;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA,CA/BA;IAgCA0B,UAhCA,sBAgCA1B,KAhCA,EAgCA;MAAA;;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,IACAA,KADA;kBAAA;kBAAA;gBAAA;;gBAAA;;cAAA;gBAIA2B,SAJA,GAIA,IAJA;;gBAAA,IAKA,sBALA;kBAAA;kBAAA;gBAAA;;gBAAA;gBAAA,OAMA,aANA;;cAAA;gBAMAA,SANA;;cAAA;gBAAA,IAQAA,SARA;kBAAA;kBAAA;gBAAA;;gBAAA;;cAAA;gBAAA;gBAAA;gBAAA,OAaAzC,2BACAC,6CACA,sBADA,CADA,EAIAa,KAJA,CAbA;;cAAA;gBAaAZ,QAbA;;gBAAA,IAmBAA,QAnBA;kBAAA;kBAAA;gBAAA;;gBAoBA;;gBApBA;;cAAA;gBAAA,IAuBAA,cAvBA;kBAAA;kBAAA;gBAAA;;gBAwBA;;gBAxBA;;cAAA;gBA2BA;kBACA;gBACA;;gBACA;;gBA9BA;gBAAA;;cAAA;gBAAA;gBAAA;;gBAgCA;;cAhCA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAkCA,CAlEA;IAmEAwC,IAnEA,kBAmEA;MAAA;;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACA;gBACA;gBACA;gBACA;;gBACA;kBACA;kBACA;kBACA;gBACA;;gBATA;;gBAAA,IAYA,sBAZA;kBAAA;kBAAA;gBAAA;;gBAAA;gBAAA,OAaA1C,6BACAC,yCADA,EAEA,mBAFA,CAbA;;cAAA;gBAaAC,QAbA;gBAAA;gBAAA;;cAAA;gBAAA;gBAAA,OAkBAF,4BACAC,sCACA,sBADA,CADA,EAIA,mBAJA,CAlBA;;cAAA;gBAkBAC,QAlBA;;cAAA;gBAAA,IAyBAA,QAzBA;kBAAA;kBAAA;gBAAA;;gBA0BA;;gBA1BA,kCA2BA,KA3BA;;cAAA;gBAAA,IA6BAA,cA7BA;kBAAA;kBAAA;gBAAA;;gBA8BA;;gBA9BA,kCA+BA,KA/BA;;cAAA;gBAiCA;gBAjCA,kCAkCA,IAlCA;;cAAA;gBAAA;gBAAA;;gBAoCA;;gBApCA,kCAqCA,KArCA;;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAuCA,CA1GA;IA2GAyC,MA3GA,qBA2GA;MAAA;;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA;gBAAA,OAGA3C,+BACAC,wCACA,sBADA,CADA,CAHA;;cAAA;gBAGAC,QAHA;;gBAAA,IAQAA,QARA;kBAAA;kBAAA;gBAAA;;gBASA;;gBATA;;cAAA;gBAAA,IAYAA,cAZA;kBAAA;kBAAA;gBAAA;;gBAaA;;gBAbA;;cAAA;gBAgBA;kBAAA0C;gBAAA;;gBAhBA;gBAAA;;cAAA;gBAAA;gBAAA;;gBAkBA;;cAlBA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAoBA,CA/HA;IAgIAC,IAhIA,kBAgIA;MACA;QAAAD;MAAA;IACA,CAlIA;IAmIAE,UAnIA,wBAmIA;MACA;MACA;MACA;QAAAxD;QAAAkC;MAAA;IACA,CAvIA;IAwIAuB,GAxIA,iBAwIA;MACA;;MACA;QACAC;MACA,CAFA,CAEA;QACAA;MACA;;MACAA;MACA;MACA;MACA;QAAA1D;QAAAkC;MAAA;IACA,CAnJA;IAoJAyB,IApJA,gBAoJAC,IApJA,EAoJA;MACA;MACA;MACA;IACA,CAxJA;IAyJAC,MAzJA,oBAyJA;MACA;MACA;MACA;IACA,CA7JA;;IA+JA;AACA;AACA;IACAC,MAlKA,oBAkKA;MACA;QACA;MACA,CAFA,CAEA;QACA;MACA;IACA,CAxKA;IAyKAC,UAzKA,sBAyKAH,IAzKA,EAyKA;MACA;MACA;MACA;IACA,CA7KA;IA8KAI,oBA9KA,kCA8KA;MACA;IACA,CAhLA;IAiLAC,UAjLA,sBAiLAxD,KAjLA,EAiLA;MACA;MACA;IACA,CApLA;IAqLAyD,OArLA,mBAqLAzD,KArLA,EAqLA;MACA;QACA;MACA;IACA,CAzLA;IA0LA0D,WA1LA,yBA0LA;MAAA;;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,MACA,yDADA;kBAAA;kBAAA;gBAAA;;gBAAA;;cAAA;gBAAA;gBAAA,OAEAzD,iDACA,2BADA,EAFA;;cAAA;gBAEA0D,mBAFA;gBAKA;;cALA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAMA;EAhMA;AAnHA","names":["name","components","FormOption","props","Form","requestDto","computed","watch","id","value","globalService","administratorAPI","response","data","m_requestDto","form","tabs","key","title","buttons","icon","color","transparent","dark","event","templateForm","m_template","headers","text","align","sortable","creating","editing","mapping","position","previewLink","templates","items","dialog","formOption","list_field_form","list_field_tempalteform","created","store","mounted","methods","initialize","id_name","getListTemplate","handleButtonClick","handleFile","canUpload","save","delete","path","back","appendItem","add","temp","edit","item","update","_items","deleteItem","openSelectFormOption","onSaveFile","onClose","getFormForm","response_All_Fields"],"sourceRoot":"src/views/modules/administrator/Request","sources":["CauHinhBieuMau.vue"],"sourcesContent":["<template>\r\n\t<v-card elevation=\"0\">\r\n\t\t<v-dialog v-model=\"dialog.formOption\">\r\n\t\t\t<FormOption @close=\"onClose\" @save=\"onSaveFile\" />\r\n\t\t</v-dialog>\r\n\t\t<v-row class=\"mt-4 px-4\">\r\n\t\t\t<v-col>\r\n\t\t\t\t<div class=\"flex gap-4\">\r\n\t\t\t\t\t<v-menu offset-y>\r\n\t\t\t\t\t\t<template v-slot:activator=\"{ on, attrs }\">\r\n\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\tv-bind=\"attrs\"\r\n\t\t\t\t\t\t\t\tv-on=\"on\"\r\n\t\t\t\t\t\t\t\t@click=\"openSelectFormOption()\"\r\n\t\t\t\t\t\t\t\t><v-icon>mdi-plus</v-icon>\r\n\t\t\t\t\t\t\t\t{{ $t(\"button.create\") }}\r\n\t\t\t\t\t\t\t\t<v-icon>mdi-menu-down</v-icon></span\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</v-menu>\r\n\t\t\t\t\t<v-divider vertical></v-divider>\r\n\t\t\t\t\t<span\r\n\t\t\t\t\t\t><v-icon>mdi-delete-outline</v-icon>\r\n\t\t\t\t\t\t{{ $t(\"button.delete\") }}</span\r\n\t\t\t\t\t>\r\n\t\t\t\t</div>\r\n\t\t\t</v-col>\r\n\t\t\t<v-col>\r\n\t\t\t\t<v-btn\r\n\t\t\t\t\tcolor=\"blue darken-1\"\r\n\t\t\t\t\tdark\r\n\t\t\t\t\tclass=\"m-2 rounded float-right\"\r\n\t\t\t\t\t@click=\"save()\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<v-icon> mdi-content-save </v-icon>\r\n\t\t\t\t\t{{ $t(\"button.save\") }}\r\n\t\t\t\t</v-btn>\r\n\t\t\t</v-col>\r\n\t\t</v-row>\r\n\t\t<v-divider></v-divider>\r\n\t\t<v-row class=\"mt-4 px-4\">\r\n\t\t\t<v-col cols=\"12\" md=\"4\">\r\n\t\t\t\t<v-row>\r\n\t\t\t\t\t<v-col>\r\n\t\t\t\t\t\t<v-combobox\r\n\t\t\t\t\t\t\tv-model=\"templateForm\"\r\n\t\t\t\t\t\t\t:items=\"templates\"\r\n\t\t\t\t\t\t\titem-text=\"templateFormName\"\r\n\t\t\t\t\t\t\toutlined\r\n\t\t\t\t\t\t\tdense\r\n\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\tmaxLength=\"255\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<template v-slot:label>\r\n\t\t\t\t\t\t\t\t{{ $t(\"label.select_template_form\") }}\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t</v-combobox>\r\n\t\t\t\t\t</v-col>\r\n\t\t\t\t</v-row>\r\n\t\t\t\t<v-row>\r\n\t\t\t\t\t<v-col cols=\"12\">\r\n\t\t\t\t\t\t<v-btn text class=\"rounded-0\" @click=\"appendItem()\">\r\n\t\t\t\t\t\t\t<v-icon> mdi-plus </v-icon>\r\n\t\t\t\t\t\t\t{{ $t(\"button.create\") }}\r\n\t\t\t\t\t\t</v-btn>\r\n\t\t\t\t\t\t<v-btn text class=\"rounded-0\">\r\n\t\t\t\t\t\t\t<v-icon> mdi-delete-outline </v-icon>\r\n\t\t\t\t\t\t\t{{ $t(\"button.delete\") }}\r\n\t\t\t\t\t\t</v-btn>\r\n\t\t\t\t\t</v-col>\r\n\t\t\t\t</v-row>\r\n\t\t\t\t<v-divider></v-divider>\r\n\t\t\t\t<v-row>\r\n\t\t\t\t\t<v-col cols=\"12\">\r\n\t\t\t\t\t\t<v-data-table\r\n\t\t\t\t\t\t\tshow-select\r\n\t\t\t\t\t\t\thide-default-footer\r\n\t\t\t\t\t\t\t:headers=\"headers\"\r\n\t\t\t\t\t\t\t:items=\"items\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<template v-slot:[`item.action`]=\"{ item }\">\r\n\t\t\t\t\t\t\t\t<v-btn\r\n\t\t\t\t\t\t\t\t\ticon\r\n\t\t\t\t\t\t\t\t\tv-if=\"editing != item\"\r\n\t\t\t\t\t\t\t\t\t@click=\"edit(item)\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<v-icon>mdi-pencil-circle </v-icon>\r\n\t\t\t\t\t\t\t\t</v-btn>\r\n\t\t\t\t\t\t\t\t<v-btn icon v-else @click=\"update\">\r\n\t\t\t\t\t\t\t\t\t<v-icon>mdi-checkbox-marked-circle </v-icon>\r\n\t\t\t\t\t\t\t\t</v-btn>\r\n\t\t\t\t\t\t\t\t<v-btn icon @click=\"deleteItem(item)\">\r\n\t\t\t\t\t\t\t\t\t<v-icon>mdi-delete-circle </v-icon>\r\n\t\t\t\t\t\t\t\t</v-btn>\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t<template v-slot:[`item.name`]=\"{ item }\">\r\n\t\t\t\t\t\t\t\t<span v-if=\"editing != item\">\r\n\t\t\t\t\t\t\t\t\t{{ item.name }}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t<v-text-field\r\n\t\t\t\t\t\t\t\t\tv-else\r\n\t\t\t\t\t\t\t\t\tdense\r\n\t\t\t\t\t\t\t\t\toutlined\r\n\t\t\t\t\t\t\t\t\tsingle-line\r\n\t\t\t\t\t\t\t\t\tv-model=\"mapping.name\"\r\n\t\t\t\t\t\t\t\t\tclass=\"mt-2\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{{ item.name }}\r\n\t\t\t\t\t\t\t\t</v-text-field>\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t<template v-slot:[`item.position`]=\"{ item }\">\r\n\t\t\t\t\t\t\t\t<span v-if=\"editing != item\">\r\n\t\t\t\t\t\t\t\t\t{{ item.position }}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t<v-text-field\r\n\t\t\t\t\t\t\t\t\tv-else\r\n\t\t\t\t\t\t\t\t\tdense\r\n\t\t\t\t\t\t\t\t\toutlined\r\n\t\t\t\t\t\t\t\t\tsingle-line\r\n\t\t\t\t\t\t\t\t\tv-model=\"mapping.position\"\r\n\t\t\t\t\t\t\t\t\tclass=\"mt-2\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{{ item.position }}\r\n\t\t\t\t\t\t\t\t</v-text-field>\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t<template v-if=\"creating\" v-slot:[`body.append`]>\r\n\t\t\t\t\t\t\t\t<tr class=\"mt-2\">\r\n\t\t\t\t\t\t\t\t\t<td></td>\r\n\t\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t\t<v-select\r\n\t\t\t\t\t\t\t\t\t\t\t:items=\"list_field_form\"\r\n\t\t\t\t\t\t\t\t\t\t\titem-text=\"id_name\"\r\n\t\t\t\t\t\t\t\t\t\t\t:item-value=\"(item) => item.id\"\r\n\t\t\t\t\t\t\t\t\t\t\t:label=\"$t('label.select_field')\"\r\n\t\t\t\t\t\t\t\t\t\t\tv-model=\"mapping.position\"\r\n\t\t\t\t\t\t\t\t\t\t\tdense\r\n\t\t\t\t\t\t\t\t\t\t\toutlined\r\n\t\t\t\t\t\t\t\t\t\t></v-select>\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t\t<v-select\r\n\t\t\t\t\t\t\t\t\t\t\t:items=\"list_field_tempalteform\"\r\n\t\t\t\t\t\t\t\t\t\t\t:label=\"$t('label.select_field')\"\r\n\t\t\t\t\t\t\t\t\t\t\tdense\r\n\t\t\t\t\t\t\t\t\t\t\toutlined\r\n\t\t\t\t\t\t\t\t\t\t\tv-model=\"mapping.name\"\r\n\t\t\t\t\t\t\t\t\t\t></v-select>\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t\t<v-btn icon @click=\"add\">\r\n\t\t\t\t\t\t\t\t\t\t\t<v-icon>mdi-plus-circle</v-icon>\r\n\t\t\t\t\t\t\t\t\t\t</v-btn>\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t</v-data-table>\r\n\t\t\t\t\t</v-col>\r\n\t\t\t\t</v-row>\r\n\t\t\t</v-col>\r\n\t\t\t<v-divider vertical></v-divider>\r\n\t\t\t<v-col cols=\"12\" md=\"8\">\r\n\t\t\t\t<v-skeleton-loader\r\n\t\t\t\t\tv-if=\"!previewLink\"\r\n\t\t\t\t\tclass=\"mx-auto\"\r\n\t\t\t\t\twidth=\"100%\"\r\n\t\t\t\t\ttype=\"card\"\r\n\t\t\t\t></v-skeleton-loader>\r\n\t\t\t\t<iframe\r\n\t\t\t\t\tv-if=\"previewLink\"\r\n\t\t\t\t\t:src=\"previewLink + '&amp;action=embedview'\"\r\n\t\t\t\t\twidth=\"100%\"\r\n\t\t\t\t\theight=\"750\"\r\n\t\t\t\t\tframeborder=\"0\"\r\n\t\t\t\t\t>This is an embedded\r\n\t\t\t\t\t<a target=\"_blank\" href=\"https://office.com\"\r\n\t\t\t\t\t\t>Microsoft Office</a\r\n\t\t\t\t\t>\r\n\t\t\t\t\tdocument, powered by\r\n\t\t\t\t\t<a target=\"_blank\" href=\"https://office.com/webapps\"\r\n\t\t\t\t\t\t>Office</a\r\n\t\t\t\t\t>.</iframe\r\n\t\t\t\t>\r\n\t\t\t</v-col>\r\n\t\t</v-row>\r\n\t</v-card>\r\n</template>\r\n\r\n<script>\r\nimport store from \"@/store\";\r\nimport TemplateFormDto from \"@/models/template-form.dto\";\r\nimport globalService from \"@/services/global.service\";\r\nimport administratorAPI from \"../administrator.api\";\r\nimport FormOption from \"../FormOption/FormOption.vue\";\r\nimport RequestDto from \"@/models/request.dto\";\r\n\r\nexport default {\r\n\tname: \"EditTempalteFormV2Vue\",\r\n\tcomponents: { FormOption },\r\n\tprops: {\r\n\t\tForm: {},\r\n\t\trequestDto: {},\r\n\t},\r\n\tcomputed: {},\r\n\twatch: {\r\n\t\t\"templateForm.attachmentFileDTOS\": async function (value) {\r\n\t\t\tlet response;\r\n\t\t\ttry {\r\n\t\t\t\tlet id = value[0].id;\r\n\t\t\t\tresponse = await globalService.getData_Async(\r\n\t\t\t\t\tadministratorAPI.API_GetPreviewLink(id),\r\n\t\t\t\t);\r\n\t\t\t\tif (!response || !response.state) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tthis.previewLink = response.data;\r\n\t\t\t\tthis.items = JSON.parse(this.templateForm.mappingInfo);\r\n\t\t\t\tthis.list_field_tempalteform = JSON.parse(\r\n\t\t\t\t\tthis.templateForm.mappingInfo,\r\n\t\t\t\t);\r\n\t\t\t\tfor (let i = 0; i < this.list_field_tempalteform.length; i++) {\r\n\t\t\t\t\tthis.list_field_tempalteform[i] =\r\n\t\t\t\t\t\tthis.list_field_tempalteform[i].name;\r\n\t\t\t\t}\r\n\t\t\t} catch {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t},\r\n\t\tForm(value) {\r\n\t\t\tthis.form = value;\r\n\t\t},\r\n\t\trequestDto(value) {\r\n\t\t\tthis.m_requestDto = value;\r\n\t\t},\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tm_requestDto: RequestDto,\r\n\t\t\tform: [],\r\n\t\t\ttabs: [{ key: \"information\", title: this.$t(\"label.information\") }],\r\n\t\t\tbuttons: [\r\n\t\t\t\t{\r\n\t\t\t\t\ticon: \"mdi-content-save\",\r\n\t\t\t\t\ttitle: this.$t(\"button.save\"),\r\n\t\t\t\t\tcolor: \"blue darken-2\",\r\n\t\t\t\t\ttransparent: false,\r\n\t\t\t\t\tdark: true,\r\n\t\t\t\t\tevent: this.save,\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ticon: \"mdi-trash-can-outline\",\r\n\t\t\t\t\ttitle: this.$t(\"button.delete\"),\r\n\t\t\t\t\tcolor: \"black\",\r\n\t\t\t\t\ttransparent: true,\r\n\t\t\t\t\tdark: false,\r\n\t\t\t\t\tevent: this.delete,\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ticon: \"mdi-arrow-left-top\",\r\n\t\t\t\t\ttitle: this.$t(\"button.back\"),\r\n\t\t\t\t\tcolor: \"black\",\r\n\t\t\t\t\ttransparent: true,\r\n\t\t\t\t\tdark: false,\r\n\t\t\t\t\tevent: this.back,\r\n\t\t\t\t},\r\n\t\t\t],\r\n\t\t\ttemplateForm: Object.assign({}, TemplateFormDto),\r\n\t\t\tm_template: Object.assign({}, TemplateFormDto),\r\n\t\t\theaders: [\r\n\t\t\t\t{\r\n\t\t\t\t\ttext: this.$t(\"Trường dữ liệu form\"),\r\n\t\t\t\t\talign: \"start\",\r\n\t\t\t\t\tvalue: \"position\",\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttext: this.$t(\"Trường dữ liệu biểu mẫu\"),\r\n\t\t\t\t\talign: \"start\",\r\n\t\t\t\t\tvalue: \"name\",\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttext: this.$t(\"label.manipulation\"),\r\n\t\t\t\t\talign: \"start\",\r\n\t\t\t\t\tsortable: false,\r\n\t\t\t\t\tvalue: \"action\",\r\n\t\t\t\t},\r\n\t\t\t],\r\n\t\t\tcreating: false,\r\n\t\t\tediting: false,\r\n\t\t\tmapping: {\r\n\t\t\t\tname: \"\",\r\n\t\t\t\tposition: \"\",\r\n\t\t\t},\r\n\t\t\tpreviewLink: \"\",\r\n\t\t\ttemplates: [],\r\n\t\t\titems: [],\r\n\t\t\tdialog: {\r\n\t\t\t\tformOption: false,\r\n\t\t\t},\r\n\t\t\tlist_field_form: [],\r\n\t\t\tlist_field_tempalteform: [],\r\n\t\t};\r\n\t},\r\n\tasync created() {\r\n\t\tstore.state.loading = false;\r\n\t\tthis.form = this.Form;\r\n\t\tthis.m_requestDto = this.requestDto;\r\n\t\tawait this.initialize();\r\n\t},\r\n\tmounted() {\r\n\t\t// store.state.loading = false;\r\n\t},\r\n\tmethods: {\r\n\t\tasync initialize() {\r\n\t\t\tawait this.getFormForm();\r\n\t\t\tif (this.form.length > 0) {\r\n\t\t\t\tfor (let i = 0; i < this.form.length; i++) {\r\n\t\t\t\t\tfor (let j = 0; j < this.form[i].elements.length; j++) {\r\n\t\t\t\t\t\tthis.list_field_form.push({\r\n\t\t\t\t\t\t\tid: `{{${this.form[i].elements[j].field.configModel.id}}}`,\r\n\t\t\t\t\t\t\tid_name:\r\n\t\t\t\t\t\t\t\tthis.form[i].elements[j].field.configModel\r\n\t\t\t\t\t\t\t\t\t.title,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync getListTemplate() {\r\n\t\t\tlet response = await globalService.getData_Async(\r\n\t\t\t\tadministratorAPI.API_GetAllTemplateForm(),\r\n\t\t\t);\r\n\t\t\tif (!response.state) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.templates = response.data.filter((entry) => {\r\n\t\t\t\treturn !entry.isDelete;\r\n\t\t\t});\r\n\t\t\tthis.sortList(this.templates);\r\n\t\t},\r\n\r\n\t\tasync handleButtonClick(event) {\r\n\t\t\tawait event();\r\n\t\t},\r\n\t\tasync handleFile(event) {\r\n\t\t\tif (!event) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet canUpload = true;\r\n\t\t\tif (!this.templateForm.id) {\r\n\t\t\t\tcanUpload = await this.save();\r\n\t\t\t}\r\n\t\t\tif (!canUpload) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet response;\r\n\t\t\ttry {\r\n\t\t\t\tresponse = await globalService.upload_Async(\r\n\t\t\t\t\tadministratorAPI.API_UploadTemplateFileCloud(\r\n\t\t\t\t\t\tthis.templateForm.id,\r\n\t\t\t\t\t),\r\n\t\t\t\t\tevent,\r\n\t\t\t\t);\r\n\t\t\t\tif (!response) {\r\n\t\t\t\t\tthis.toastError(response);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (!response.state) {\r\n\t\t\t\t\tthis.toastError(response.messgage);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (!this.templateForm.attachmentFileDTOS) {\r\n\t\t\t\t\tthis.templateForm.attachmentFileDTOS = [];\r\n\t\t\t\t}\r\n\t\t\t\tthis.templateForm.attachmentFileDTOS.push(response.data);\r\n\t\t\t} catch (error) {\r\n\t\t\t\tthis.toastError(error);\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync save() {\r\n\t\t\tthis.templateForm.mappingInfo = JSON.stringify(this.items);\r\n\t\t\tthis.templateForm.modified = this.getUserInfo();\r\n\t\t\tthis.templateForm.modifiedDate = new Date();\r\n\t\t\tthis.templateForm.modifiedName = this.getUserInfo().fullName;\r\n\t\t\tif (!this.templateForm.id) {\r\n\t\t\t\tthis.templateForm.created = this.getUserInfo();\r\n\t\t\t\tthis.templateForm.createdDate = new Date();\r\n\t\t\t\tthis.templateForm.createdName = this.getUserInfo().fullName;\r\n\t\t\t}\r\n\t\t\tlet response;\r\n\t\t\ttry {\r\n\t\t\t\tif (!this.templateForm.id) {\r\n\t\t\t\t\tresponse = await globalService.postData_Async(\r\n\t\t\t\t\t\tadministratorAPI.API_CreateTemplateForm(),\r\n\t\t\t\t\t\tthis.templateForm,\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresponse = await globalService.putData_Async(\r\n\t\t\t\t\t\tadministratorAPI.API_SaveTemplateForm(\r\n\t\t\t\t\t\t\tthis.templateForm.id,\r\n\t\t\t\t\t\t),\r\n\t\t\t\t\t\tthis.templateForm,\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tif (!response) {\r\n\t\t\t\t\tthis.toastError(response);\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tif (!response.state) {\r\n\t\t\t\t\tthis.toastError(response.messgage);\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tthis.templateForm = response.data;\r\n\t\t\t\treturn true;\r\n\t\t\t} catch (error) {\r\n\t\t\t\tthis.toastError(error);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync delete() {\r\n\t\t\tlet response;\r\n\t\t\ttry {\r\n\t\t\t\tresponse = await globalService.deleteData_Async(\r\n\t\t\t\t\tadministratorAPI.API_DeleteTemplateForm(\r\n\t\t\t\t\t\tthis.templateForm.id,\r\n\t\t\t\t\t),\r\n\t\t\t\t);\r\n\t\t\t\tif (!response) {\r\n\t\t\t\t\tthis.toastError(response);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (!response.state) {\r\n\t\t\t\t\tthis.toastError(response.messgage);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tthis.$router.push({ path: \".\" });\r\n\t\t\t} catch (error) {\r\n\t\t\t\tthis.toastError(error);\r\n\t\t\t}\r\n\t\t},\r\n\t\tback() {\r\n\t\t\tthis.$router.push({ path: \"./\" });\r\n\t\t},\r\n\t\tappendItem() {\r\n\t\t\tthis.creating = true;\r\n\t\t\tthis.editing = null;\r\n\t\t\tthis.mapping = { name: \"\", position: \"\" };\r\n\t\t},\r\n\t\tadd() {\r\n\t\t\tlet temp = [];\r\n\t\t\ttry {\r\n\t\t\t\ttemp = JSON.parse(this.templateForm.mappingInfo);\r\n\t\t\t} catch (error) {\r\n\t\t\t\ttemp = [];\r\n\t\t\t}\r\n\t\t\ttemp.push(this.mapping);\r\n\t\t\tthis.items.push(this.mapping);\r\n\t\t\tthis.templateForm.mappingInfo = JSON.stringify(temp);\r\n\t\t\tthis.mapping = { name: \"\", position: \"\" };\r\n\t\t},\r\n\t\tedit(item) {\r\n\t\t\tthis.editing = item;\r\n\t\t\tthis.mapping = item;\r\n\t\t\tthis.creating = false;\r\n\t\t},\r\n\t\tupdate() {\r\n\t\t\tthis.templateForm.mappingInfo = JSON.stringify(this.items);\r\n\t\t\tthis.creating = false;\r\n\t\t\tthis.editing = null;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * @return {Array}\r\n\t\t */\r\n\t\t_items() {\r\n\t\t\ttry {\r\n\t\t\t\treturn JSON.parse(this.templateForm.mappingInfo);\r\n\t\t\t} catch (error) {\r\n\t\t\t\treturn [];\r\n\t\t\t}\r\n\t\t},\r\n\t\tdeleteItem(item) {\r\n\t\t\tlet index = this.items.indexOf(item);\r\n\t\t\tthis.items.splice(index, 1);\r\n\t\t\tthis.templateForm.mappingInfo = JSON.stringify(this.items);\r\n\t\t},\r\n\t\topenSelectFormOption() {\r\n\t\t\tthis.dialog.formOption = true;\r\n\t\t},\r\n\t\tonSaveFile(value) {\r\n\t\t\tthis.listFile = value;\r\n\t\t\tthis.templates = value;\r\n\t\t},\r\n\t\tonClose(value) {\r\n\t\t\tif (value) {\r\n\t\t\t\tthis.dialog.formOption = false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync getFormForm() {\r\n\t\t\tif (!this.m_requestDto.form || !this.m_requestDto.form.id) return;\r\n\t\t\tlet response_All_Fields = await globalService.getData_Async(\r\n\t\t\t\t`/api/forms/${this.m_requestDto.form.id}`,\r\n\t\t\t);\r\n\t\t\tthis.form = JSON.parse(response_All_Fields.data.objectSchema);\r\n\t\t},\r\n\t},\r\n};\r\n</script>\r\n\r\n<style></style>\r\n"]},"metadata":{},"sourceType":"module"}